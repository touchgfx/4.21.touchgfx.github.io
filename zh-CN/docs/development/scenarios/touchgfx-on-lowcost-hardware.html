<!doctype html>
<html lang="zh-CN" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-development/scenarios/touchgfx-on-lowcost-hardware">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.1">
<link rel="search" type="application/opensearchdescription+xml" title="TouchGFX Documentation" href="/4.21/zh-CN/opensearch.xml">
<script src="/4.21/zh-CN/js/one-trust.js"></script>
<script src="/4.21/js/fix-location.js"></script><title data-rh="true">低成本硬件上的TouchGFX | TouchGFX Documentation</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://support.touchgfx.com/4.21/zh-CN/img/meta-image.png"><meta data-rh="true" name="twitter:image" content="https://support.touchgfx.com/4.21/zh-CN/img/meta-image.png"><meta data-rh="true" property="og:url" content="https://support.touchgfx.com/4.21/zh-CN/docs/development/scenarios/touchgfx-on-lowcost-hardware"><meta data-rh="true" name="docusaurus_locale" content="zh-CN"><meta data-rh="true" name="docsearch:language" content="zh-CN"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="低成本硬件上的TouchGFX | TouchGFX Documentation"><link data-rh="true" rel="icon" href="/4.21/zh-CN/img/favicon.png"><link data-rh="true" rel="canonical" href="https://support.touchgfx.com/4.21/zh-CN/docs/development/scenarios/touchgfx-on-lowcost-hardware"><link data-rh="true" rel="alternate" href="https://support.touchgfx.com/4.21/docs/development/scenarios/touchgfx-on-lowcost-hardware" hreflang="en"><link data-rh="true" rel="alternate" href="https://support.touchgfx.com/4.21/ko/docs/development/scenarios/touchgfx-on-lowcost-hardware" hreflang="ko"><link data-rh="true" rel="alternate" href="https://support.touchgfx.com/4.21/ja/docs/development/scenarios/touchgfx-on-lowcost-hardware" hreflang="ja"><link data-rh="true" rel="alternate" href="https://support.touchgfx.com/4.21/zh-CN/docs/development/scenarios/touchgfx-on-lowcost-hardware" hreflang="zh-CN"><link data-rh="true" rel="alternate" href="https://support.touchgfx.com/4.21/zh-TW/docs/development/scenarios/touchgfx-on-lowcost-hardware" hreflang="zh-TW"><link data-rh="true" rel="alternate" href="https://support.touchgfx.com/4.21/docs/development/scenarios/touchgfx-on-lowcost-hardware" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://B8LNOI0XWD-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/4.21/zh-CN/assets/css/styles.a3789d89.css">
<link rel="preload" href="/4.21/zh-CN/assets/js/runtime~main.1202490c.js" as="script">
<link rel="preload" href="/4.21/zh-CN/assets/js/main.8eee2a9c.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><div role="region"><a href="#" class="skipToContent_fXgn">跳转到主要内容</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" target="_self" href="/4.21/zh-CN/docs/introduction/welcome"><div class="navbar__logo"><img src="/4.21/zh-CN/img/logo.svg" alt="TouchGFX" class="themedImage_ToTc themedImage--light_HNdA"><img src="/4.21/zh-CN/img/logo.svg" alt="TouchGFX" class="themedImage_ToTc themedImage--dark_i4oU"></div></a><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">简体中文</a><ul class="dropdown__menu"><li><a href="/4.21/docs/development/scenarios/touchgfx-on-lowcost-hardware" target="_self" rel="noopener noreferrer" class="dropdown__link">English</a></li><li><a href="/4.21/ko/docs/development/scenarios/touchgfx-on-lowcost-hardware" target="_self" rel="noopener noreferrer" class="dropdown__link">한국어</a></li><li><a href="/4.21/ja/docs/development/scenarios/touchgfx-on-lowcost-hardware" target="_self" rel="noopener noreferrer" class="dropdown__link">日本語</a></li><li><a href="/4.21/zh-CN/docs/development/scenarios/touchgfx-on-lowcost-hardware" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active">简体中文</a></li><li><a href="/4.21/zh-TW/docs/development/scenarios/touchgfx-on-lowcost-hardware" target="_self" rel="noopener noreferrer" class="dropdown__link">繁體中文</a></li></ul></div></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class="navbar__link" aria-haspopup="true" aria-expanded="false" role="button" href="/4.21/zh-CN/docs/introduction/welcome">4.21</a><ul class="dropdown__menu"><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/4.21/zh-CN/docs/development/scenarios/touchgfx-on-lowcost-hardware">4.21</a></li><li><a href="https://support.touchgfx.com/4.20" target="_blank" rel="noopener noreferrer" class="dropdown__link">4.20<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a href="https://support.touchgfx.com/4.19" target="_blank" rel="noopener noreferrer" class="dropdown__link">4.19<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a href="https://support.touchgfx.com/4.18" target="_blank" rel="noopener noreferrer" class="dropdown__link">4.18<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a href="https://support.touchgfx.com/4.17" target="_blank" rel="noopener noreferrer" class="dropdown__link">4.17<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a href="https://support.touchgfx.com/4.16" target="_blank" rel="noopener noreferrer" class="dropdown__link">4.16<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a href="https://support.touchgfx.com/4.15" target="_blank" rel="noopener noreferrer" class="dropdown__link">4.15<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a href="https://support.touchgfx.com/4.14" target="_blank" rel="noopener noreferrer" class="dropdown__link">4.14<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a href="https://support.touchgfx.com/4.13" target="_blank" rel="noopener noreferrer" class="dropdown__link">4.13<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><a href="https://community.st.com/s/topic/0TO0X0000003iw6WAA/touchgfx" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">社区</a><a href="https://touchgfx.com/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">TouchGFX.com</a><div class="searchBox_ZlJk"><div class="searchBox_Gz_y"><button type="button" class="DocSearch DocSearch-Button" aria-label="搜索"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">搜索</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd"><nav class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/4.21/zh-CN/docs/category/introduction">介绍</a><button aria-label="Toggle the collapsible sidebar category &#x27;介绍&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/4.21/zh-CN/docs/category/basic-concepts">基本概念</a><button aria-label="Toggle the collapsible sidebar category &#x27;基本概念&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/4.21/zh-CN/docs/development/development-introduction">开发</a><button aria-label="Toggle the collapsible sidebar category &#x27;开发&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/4.21/zh-CN/docs/development/hardware-selection/hardware-selection-introduction">硬件选择</a><button aria-label="Toggle the collapsible sidebar category &#x27;硬件选择&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/4.21/zh-CN/docs/development/board-bring-up/board-introduction">驱动板卡</a><button aria-label="Toggle the collapsible sidebar category &#x27;驱动板卡&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/4.21/zh-CN/docs/development/touchgfx-hal-development/touchgfx-al-development-introduction">TouchGFX AL开发</a><button aria-label="Toggle the collapsible sidebar category &#x27;TouchGFX AL开发&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/4.21/zh-CN/docs/development/ui-development/ui-development-introduction">UI开发</a><button aria-label="Toggle the collapsible sidebar category &#x27;UI开发&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" tabindex="0" href="/4.21/zh-CN/docs/category/scenarios-2">场景</a><button aria-label="Toggle the collapsible sidebar category &#x27;场景&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/4.21/zh-CN/docs/development/scenarios/touchgfx-on-lowcost-hardware">低成本硬件上的TouchGFX</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/4.21/zh-CN/docs/development/scenarios/touchgfx-on-gpu2d">TouchGFX on NeoChrom</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/4.21/zh-CN/docs/development/scenarios/lowering-memory-usage-with-partial-framebuffer">通过部分帧缓冲降低内存使用率</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/4.21/zh-CN/docs/development/scenarios/using-non-memory-mapped-flash">使用非内存映射闪存存储图像</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/4.21/zh-CN/docs/development/scenarios/using-serial-flash">使用串行闪存存储图像和字体</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/4.21/zh-CN/docs/development/scenarios/fonts-in-unmapped-flash">使用非内存映射闪存存储字体数据</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/4.21/zh-CN/docs/development/scenarios/scenarios-change-pixelformat-bpp">更改应用的像素格式</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/4.21/zh-CN/docs/development/scenarios/scenarios-create-at">创建TouchGFX应用模板</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/4.21/zh-CN/docs/development/scenarios/example-gpio">外部事件作为触发器</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/4.21/zh-CN/docs/development/scenarios/running-without-rtos">在无RTOS的情况下基于TouchGFX硬件模板上运行项目</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/4.21/zh-CN/docs/development/scenarios/adding-files-to-stm32cubemx-projet">向STM32CubeMX工程中添加文件</a></li></ul></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/4.21/zh-CN/docs/category/miscellaneous-1">其他情况</a><button aria-label="Toggle the collapsible sidebar category &#x27;其他情况&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/4.21/zh-CN/docs/category/tutorials">指导</a><button aria-label="Toggle the collapsible sidebar category &#x27;指导&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/4.21/zh-CN/docs/api/classes/classtouchgfx_1_1_abstract_button">API</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/4.21/zh-CN/docs/category/resources">资源</a><button aria-label="Toggle the collapsible sidebar category &#x27;资源&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/4.21/zh-CN/docs/development/development-introduction"><span itemprop="name">开发</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/4.21/zh-CN/docs/category/scenarios-2"><span itemprop="name">场景</span></a><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">低成本硬件上的TouchGFX</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">在当前页面</button></div><div class="theme-doc-markdown markdown"><header><h1>低成本硬件上的TouchGFX</h1></header><p>This section discusses how to use TouchGFX on low cost hardware with limited amount of RAM and flash, no acceleration and &quot;slow&quot; SPI connection to external flash and display.</p><p>我们将尝试提供一些关于为指定硬件编写最佳应用的建议。</p><p>Throughout this section we will use the TouchGFX board setup for the STM32G071 Nucleo board with the X-Nucleo-GFX01M1 expansion board as example hardware. The expansion board features a 16-bit display and a serial flash.</p><div class="figure"><a href="/4.21/zh-CN/img/development/ui-development/scenarios/lowering-memory-usage-with-partial-framebuffer/g071-with-gfx01m1.webp" target="_blank"><img src="/4.21/zh-CN/img/development/ui-development/scenarios/lowering-memory-usage-with-partial-framebuffer/g071-with-gfx01m1.webp"></a><p>Nucleo-G071RB和X-Nucleo-GFX01M1扩展板</p></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="hardware-overview">硬件概述<a class="hash-link" href="#hardware-overview" title="直接链接到标题">​</a></h2><p>该套件中的硬件配置包括STM32G071 MCU、SPI NOR flash、SPI显示屏和摇杆按钮。</p><table><thead><tr><th><strong>组件</strong></th><th align="right"> </th></tr></thead><tbody><tr><td>MCU</td><td align="right">STM32G071RB</td></tr><tr><td>MCU RAM</td><td align="right">32 Kb</td></tr><tr><td>MCU Flash</td><td align="right">128 Kb</td></tr><tr><td>显示屏</td><td align="right">Displaytech DT022CTFT</td></tr><tr><td>显示屏分辨率</td><td align="right">240 x 320</td></tr><tr><td>Display format</td><td align="right">16-bit RGB565</td></tr><tr><td>显示屏控制器</td><td align="right">ILI9341V</td></tr><tr><td>显示屏连接</td><td align="right">SPI</td></tr><tr><td>显示屏连接速度</td><td align="right">32 MHz</td></tr><tr><td>NOR Flash</td><td align="right">Macronix MX25L6433F</td></tr><tr><td>NOR Flash大小</td><td align="right">64 Mbit</td></tr><tr><td>NOR Flash连接速度</td><td align="right">32 MHz</td></tr></tbody></table><p>显示屏连接到SPI1外设，而闪存连接到SPI2外设。 因此，MCU能够在向显示屏发送数据的同时从闪存读取数据。</p><div class="figure"><a href="/4.21/zh-CN/img/development/scenarios/touchgfx-on-lowcost-hardware/g071-gfx01m1-architecture.webp" target="_blank"><img width="500px" src="/4.21/zh-CN/img/development/scenarios/touchgfx-on-lowcost-hardware/g071-gfx01m1-architecture.webp"></a><p>具有X-Nucleo-GFX01M1架构的Nucleo-G071RB</p></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="gpio-allocation">GPIO分配<a class="hash-link" href="#gpio-allocation" title="直接链接到标题">​</a></h3><table><thead><tr><th><strong>信号</strong></th><th><strong>GPIO引脚</strong></th></tr></thead><tbody><tr><td>显示屏CS</td><td>PB5</td></tr><tr><td>显示屏DCX</td><td>PB3</td></tr><tr><td>显示屏SCK</td><td>PA5</td></tr><tr><td>显示屏MOSI</td><td>PA7</td></tr><tr><td>显示屏TE</td><td>PA0</td></tr><tr><td>Flash CS</td><td>PB9</td></tr><tr><td>Flash SCK</td><td>PB13</td></tr><tr><td>Flash MOSI</td><td>PC3</td></tr><tr><td>Flash MISO</td><td>PC2</td></tr></tbody></table><p>上表列出了闪存和显示屏的信号GPIO分配。 这些信号可通过示波器或逻辑分析仪进行监测。 This is very useful during debugging of e.g. performance problems.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="starting-a-project">启动项目<a class="hash-link" href="#starting-a-project" title="直接链接到标题">​</a></h3><p>在TouchGFX Designer中，可以轻松地为STM32G071RB Nucleo评估套件启动一个项目。 点击“Create New”按钮，然后搜索STM32G071 Nucleo。  此模板专为Nucleo-G071RB套件和X-Nucleo-GFX01M1显示板卡而开发。</p><div class="figure"><a href="/4.21/zh-CN/img/development/scenarios/touchgfx-on-lowcost-hardware/g071-start-new-project-4.17.webp" target="_blank"><img src="/4.21/zh-CN/img/development/scenarios/touchgfx-on-lowcost-hardware/g071-start-new-project-4.17.webp"></a><p>Nucleo-G071RB的新项目</p></div><p>该应用模板支持NOR flash、显示屏和按钮。 The display can be used both in portrait and horizontal mode.</p><p>可以在TouchGFX Designer中的 <em>配置 -&gt; 显示屏</em>部分修改显示屏方向：</p><div class="figure"><a href="/4.21/zh-CN/img/development/scenarios/touchgfx-on-lowcost-hardware/portrait-4.17.webp" target="_blank"><img src="/4.21/zh-CN/img/development/scenarios/touchgfx-on-lowcost-hardware/portrait-4.17.webp"></a><p>选择竖屏或横屏显示</p></div><p>The display on the X-Nucleo-GFX01M1 shield is natively portrait oriented (higher than wide), but it can easily be used with horizontal orientation.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="display-updates">显示屏更新<a class="hash-link" href="#display-updates" title="直接链接到标题">​</a></h2><p>如上文所述，显示屏分辨率为240 x 320像素。 总共76,800像素或153,600字节。 MCU与显示屏之间的SPI连接的运行频率为32 MHz。 因此，传输速度可以达到4 MB/s或2M像素/s。</p><p>显示屏的刷新频率为76.1 Hz，因此帧间隔为13.14 ms。</p><div class="figure"><a href="/4.21/zh-CN/img/development/scenarios/touchgfx-on-lowcost-hardware/display-te.webp" target="_blank"><img src="/4.21/zh-CN/img/development/scenarios/touchgfx-on-lowcost-hardware/display-te.webp"></a><p>显示屏的撕裂信号</p></div><p>这意味着有最多13 ms的时间来发送下一帧的数据。 In that time we can send 2.000.000 pixels/s / 76 fps = 26.280 pixels / frame or 34% of a full screen. In practice we cannot sustain that transfer speed on the SPI bus because of the protocol overhead so we cannot expect to send more than approximately 30% of a full frame.</p><p>如果应用更新的像素数超过此值，硬件将无法在帧时以内完成发送。 结果是显示屏将在全部更新结束前开始显示更新的帧。 因此，用户有时会看到原来的帧与新的帧混合在一起的画面。</p><p>对于一些动画而言，用户注意不到这一点，但在其他情况下可能不可接受。</p><p>因此，我们建议将更新率维持在30%以下。 如 通过渐进式地分步更新帧。</p><p>因此，一般来说最好在屏幕上扩展项目，而不是移动项目。</p><div class="figure"><a href="/4.21/zh-CN/img/development/scenarios/touchgfx-on-lowcost-hardware/star.webp" target="_blank"><img width="400" src="/4.21/zh-CN/img/development/scenarios/touchgfx-on-lowcost-hardware/star.webp"></a><p>显示屏的撕裂信号</p></div><p>当星形移动到右侧时，必须更新星形覆盖的所有像素。 如果只扩展星形，则只需更新新像素。 在上一帧更新的像素保持不变。</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="drawing-speed">绘制速度<a class="hash-link" href="#drawing-speed" title="直接链接到标题">​</a></h3><p>向显示屏发送数据的频率为最高32 MHz。</p><p>串行闪存能以与显示屏发送相同的速度运行。 这意味着串行闪存的速度足够快，能以最高速度向显示屏供应数据。</p><p>这只有在闪存中的图像像素格式为RGB565时才能实现。 In this case is two bytes read from the flash equal to 1 pixel, which is also two bytes on the display. If the pixel format in the flash is ARGB8888, we need to read double the amount of data from the flash to produce a pixel on the display, and the serial flash will not be able to keep up with the display.</p><p>When this happens we are not sending data to the display continuously and it will not be possible to update all 30% of the display in a frame. 一种办法是将图像移动到内部闪存，另一种办法当然是更改像素格式。</p><p>其他控件不受闪存速度的制约。 如 Box控件，用于绘制彩色矩形。 此控件速度很快，比显示屏数据发送速度要快许多。 其他控件（如Line和Circle控件）需要使用更多CPU资源。 这些控件生成像素的速度比不上将它们发送给显示屏时的速度。 对于使用这些控件的应用，不能期望在每帧时间内更新显示屏30%区域。</p><p>点击<a href="/4.21/zh-CN/docs/basic-concepts/performance#the-complexity-of-rendering-the-pixels">这里</a>了解像素渲染的复杂性</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="touchgfx-limitations-with-serial-flash">使用串行闪存时TouchGFX的限制<a class="hash-link" href="#touchgfx-limitations-with-serial-flash" title="直接链接到标题">​</a></h2><p>应用程序员必须认识到，在STM32G0平台使用串行闪存时，使用TouchGFX有少许限制。</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="texture-mapper">纹理映射器<a class="hash-link" href="#texture-mapper" title="直接链接到标题">​</a></h3><p>纹理映射器控件（TextureMapper、AnimationTextureMapper和 ScalableImage）不能绘制存储在外部SPI闪存中的图像。 原因在于，用存储在串行闪存中的图像无法获得可接受的性能，如图像旋转。</p><p>在Texture Mapper控件中使用图像时，必须将图像保存在内部闪存或RAM中。 可通过TouchGFX Designer修改图像配置，轻松地将图像保存在内部闪存中。</p><p>转至Images选项卡并选中图像。 在窗口的右侧，将“Section”属性更改为“IntFlashSection”。</p><div class="figure"><a href="/4.21/zh-CN/img/development/scenarios/touchgfx-on-lowcost-hardware/image-internal-4.17.webp" target="_blank"><img src="/4.21/zh-CN/img/development/scenarios/touchgfx-on-lowcost-hardware/image-internal-4.17.webp"></a><p>将图像放入内部闪存</p></div><p>Texture Mapper的代码量过大，不能包含在所有项目中。 因此，对于STM32G0项目，默认禁用Texture Mapper。 这意味着您必须先全能Texture Mapper，然后才能在STM32G0项目中使用它。</p><p>转至“Config”选项卡，选择“Framework Features”，并点击相关的一个或一组Texture Mapper。</p><div class="figure"><a href="/4.21/zh-CN/img/development/scenarios/touchgfx-on-lowcost-hardware/enabling-texture-mapper-4.17.webp" target="_blank"><img src="/4.21/zh-CN/img/development/scenarios/touchgfx-on-lowcost-hardware/enabling-texture-mapper-4.17.webp"></a><p>为特定图像格式启用Texture Mapper</p></div><p>还可以使用<a href="/4.21/zh-CN/docs/development/ui-development/touchgfx-engine-features/caching-bitmaps">Bitmap Cache</a>将图像暂时移动到RAM</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="bitmap-painter">位图绘制器<a class="hash-link" href="#bitmap-painter" title="直接链接到标题">​</a></h3><p>可通过图像为直线、圆和DynamicGraph上色。 这不适用于存储在SPI闪存中的图像。 使用这些控件的图像必须放在内部闪存或RAM中。</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="l8-palette">L8调色板<a class="hash-link" href="#l8-palette" title="直接链接到标题">​</a></h3><p>L8格式的图像可以用在具有串行闪存的硬件上。 限制条件是调色板数据必须放在内部闪存中（也是出于性能考虑）。</p><p>通过在TouchGFX Designer中将“Extra Section”修改为“IntFlashSection”，可以将调色板移动到内部闪存。</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="drivers">驱动<a class="hash-link" href="#drivers" title="直接链接到标题">​</a></h2><p>应用模板是使用TouchGFX Generator创建的。 Read more about the Generator <a href="/4.21/zh-CN/docs/development/touchgfx-hal-development/generator-how-to/enabling-touchgfx-generator">here</a>. TouchGFX Generator生成HAL层，它连接TouchGFX框架与一组底层驱动程序（已在该应用模板中实现）。 该应用模板的底层驱动位于项目的<code>Core/Src</code>文件夹中。</p><p>驱动程序位于3个文件中：</p><table><thead><tr><th><strong>驱动</strong></th><th><strong>文件</strong></th></tr></thead><tbody><tr><td>显示屏</td><td>Core/Src/MB1642BDisplayDriver.c</td></tr><tr><td>Flash</td><td>Core/Src/MB1642BDataReader.c</td></tr><tr><td>按钮</td><td>Core/Src/MB1642BButtonController.cpp</td></tr></tbody></table><h3 class="anchor anchorWithStickyNavbar_LWe7" id="display">显示屏<a class="hash-link" href="#display" title="直接链接到标题">​</a></h3><p>显示屏使用标准SPI协议。 A number of registers is the display can be written to configure the display. 在数据发送到显示屏时生成片选信号。 使用额外的GPIO（DCX）将指令字节与数据字节区分开来。</p><p>驱动使用DMA通道发送像素数据给显示屏。 这样就可以在MCU计算像素的同时进行发送。 DMA完成中断被用来释放已发送数据的存储空间以便在将来绘制时重复使用，以及在有新数据可用时重新开始发送数据。</p><p>Configuration data is not send with DMA, because the CS and CDX pins must be toggled between and in the small configuration packages according to the protocol of this display.</p><p>在发送配置数据时，驱动使用8位模式的SPI，但在发送像素数据时改为16位模式。 其中的原因在于，MCU存储器以小端模式读取。 RGB565格式的像素存储在RAM中，首先是低字节（G和B），然后是高字节（R和G）。 当使用8位SPI发送内存数据时，此顺序维持不变。 当SPI为16位模式时，按16位RGB565从存储器读取数据，并按显示屏的正确顺序发送数据。</p><p>对于不使用16位DMA的驱动，必须在发送前交换像素中的字节序。</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="initialization">Initialization<a class="hash-link" href="#initialization" title="直接链接到标题">​</a></h4><p>The display initialization is found in the function <code>MB1642BDisplayDriver_DisplayInit(void)</code></p><p>驱动按照推荐的上电顺序向显示屏发送6个指令：</p><ol><li>退出睡眠模式（11h）</li><li>进入正常模式（13h）</li><li>设置存储器存取控制（36h），MX和BGR位置位</li><li>设置像素格式（3Ah）为16位格式</li><li>撕裂行功能开启（35h）</li><li>设置撕裂扫描行（44h）使其 = 0</li></ol><p>驱动会在这些指令之间休眠100 ms。</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="tearing-effect">撕裂效应<a class="hash-link" href="#tearing-effect" title="直接链接到标题">​</a></h4><p>来自显示屏的撕裂效应（TE）信号非常重要。 It allows the application to synchronize the update of the display memory correctly with the display refresh rate. This helps the application to avoid tearing on the display. The display asserts the signal whenever it starts an update cycle. The MCU uses this signal to start sending data to the display.</p><p>TE信号连接到MCU的外部中断输入。 CubeMx生成并配置该引脚上的中断。</p><p>驱动中的回调指示TouchGFX开始绘制：</p><div class="code-header"><div><h5>MB1642BDisplayDriver.c</h5></div></div><div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">void</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">HAL_GPIO_EXTI_Rising_Callback</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token keyword" style="font-style:italic">uint16_t</span><span class="token plain"> GPIO_Pin</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token function" style="color:rgb(130, 170, 255)">touchgfxSignalVSync</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="external-flash">外部闪存<a class="hash-link" href="#external-flash" title="直接链接到标题">​</a></h3><p>显示板卡上的SPI NOR flash是标准SPI flash。 该驱动比显示屏驱动简单。 No special initialization is required to read data from the flash.</p><p>The driver can read data using polled SPI (busy waiting for all the bytes) or use DMA. The time to start a DMA reception is similar to the time it takes to read 20 bytes in polled mode, so it is often slower for short reads. On the other hand, the DMA continues to run during interrupts (e.g. sysTick or application interrupts) and can run in the background when the MCU is busy rendering pixels. For this reason both methods are used.</p><p>The flash driver is using another DMA channel than the display driver, so both reception of new data and transmission of already drawn pixels can run concurrently.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="linker-script">链接脚本<a class="hash-link" href="#linker-script" title="直接链接到标题">​</a></h4><p>链接器控制应用中各种数据所在的位置。 这是在链接脚本中指定的。 下面是gcc编译器的链接器脚本的第一部分：</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">MEMORY</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">{</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  RAM        (xrw)    : ORIGIN = 0x20000000,   LENGTH = 36K</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  FLASH      (rx)     : ORIGIN = 0x8000000,    LENGTH = 128K</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  SPI_FLASH  (r)      : ORIGIN = 0x90000000,   LENGTH = 8M</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>It declares the NOR flash as starting from the address 0x90000000. The flash driver in the target application reads data in the 0x90000000 addresses from the SPI flash (using the lower 24-bits as address in the flash).</p><p>The External Flash Loader used in STM32CubeProgrammer can flash data in this range to the SPI flash (see below).</p><p>第二部分将图像（ExtFlashSection）和字体（FontFlashSection）数据放在SPI闪存中。</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">  ExtFlashSection :</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    *(ExtFlashSection ExtFlashSection.*)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    *(.gnu.linkonce.r.*)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    . = ALIGN(0x4);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  } &gt;SPI_FLASH</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  FontFlashSection :</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    *(FontFlashSection FontFlashSection.*)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    *(.gnu.linkonce.r.*)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    . = ALIGN(0x4);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  } &gt;SPI_FLASH</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>通过向链接器脚本中添加相似分区，可将其他数据放入SPI闪存。</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="flash-loader">外部闪存下载<a class="hash-link" href="#flash-loader" title="直接链接到标题">​</a></h4><p>G071 TouchGFX应用模板包含STM32CubeProgrammer要使用到的flash loader算法， 用于将数据写入SPI NOR flash。</p><p>flash loader文件为<code>gcc/S25FL032P_STM32G071B-NUCLEO.stldr</code></p><p>A STM32CubeIDE project can be flashed directly from the CubeIDE, but an IAR or Keil application must be flashed from STM32CubeProgrammer.</p><p>The flash loader is not available in STM32CubeProgrammer initially, so it must be installed by copying the stldr file to the installation:</p><div class="figure"><a href="/4.21/zh-CN/img/development/scenarios/touchgfx-on-lowcost-hardware/copying-stldr.webp" target="_blank"><img src="/4.21/zh-CN/img/development/scenarios/touchgfx-on-lowcost-hardware/copying-stldr.webp"></a><p>复制flash loader到STM32CubeProgrammer安装文件夹</p></div><p>Now the flash loader can be selected in STM32CubeProgrammer as normal:</p><div class="figure"><a href="/4.21/zh-CN/img/development/scenarios/touchgfx-on-lowcost-hardware/select-stldr.webp" target="_blank"><img src="/4.21/zh-CN/img/development/scenarios/touchgfx-on-lowcost-hardware/select-stldr.webp"></a><p>复制flash loader到STM32CubeProgrammer安装文件夹</p></div><div class="highlight highlight-tip"><div class="highlight-heading"><h5><div class="highlight-icon"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></div>Tip</h5></div><div class="highlight-content">此flash loader只能与Nucleo-G071RB板上使用特定GPIO配置配合使用。<p>如果在自定义硬件上对串行闪存使用其他GPIO配置，则必须相应地修改flash loader。</p></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="buttons">按钮<a class="hash-link" href="#buttons" title="直接链接到标题">​</a></h3><p>按钮驱动十分简单。 它对MB1642B上的摇杆和Nucleo板上的蓝色用户按钮使用的5个GPIO的状态进行采样。</p><p>此按钮驱动作为BottonController安装在TouchGFX中。 这意味着在TouchGFX Designer中可以直接将按钮点击用在交互的配置中。 还可以在用户代码中使用它们，例如：</p><div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">void</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(255, 203, 107)">Screen1View</span><span class="token double-colon punctuation" style="color:rgb(199, 146, 234)">::</span><span class="token function" style="color:rgb(130, 170, 255)">handleKeyEvent</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token keyword" style="font-style:italic">uint8_t</span><span class="token plain"> key</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">key </span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token plain"> </span><span class="token char" style="color:rgb(130, 170, 255)">&#x27;6&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token function" style="color:rgb(130, 170, 255)">application</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token function" style="color:rgb(130, 170, 255)">gotoScreen2Screen</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>使用的键码：</p><table><thead><tr><th><strong>按键</strong></th><th align="right"><strong>键值编码</strong></th></tr></thead><tbody><tr><td>左</td><td align="right">&#x27;4&#x27;</td></tr><tr><td>右</td><td align="right">&#x27;6&#x27;</td></tr><tr><td>上</td><td align="right">&#x27;8&#x27;</td></tr><tr><td>下</td><td align="right">&#x27;2&#x27;</td></tr><tr><td>中</td><td align="right">&#x27;5&#x27;</td></tr><tr><td>蓝色用户按钮</td><td align="right">&#x27;0&#x27;</td></tr></tbody></table><p>These keys are also usable when you run the Simulator (hit <code>F5</code> in the TouchGFX Designer) by using the keyboard numpad.</p></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="文档页面导航"><a class="pagination-nav__link pagination-nav__link--prev" href="/4.21/zh-CN/docs/category/scenarios-2"><div class="pagination-nav__sublabel">上一个</div><div class="pagination-nav__label">Scenarios</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/4.21/zh-CN/docs/development/scenarios/touchgfx-on-gpu2d"><div class="pagination-nav__sublabel">下一个</div><div class="pagination-nav__label">TouchGFX on NeoChrom</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#hardware-overview" class="table-of-contents__link toc-highlight">硬件概述</a><ul><li><a href="#gpio-allocation" class="table-of-contents__link toc-highlight">GPIO分配</a></li><li><a href="#starting-a-project" class="table-of-contents__link toc-highlight">启动项目</a></li></ul></li><li><a href="#display-updates" class="table-of-contents__link toc-highlight">显示屏更新</a><ul><li><a href="#drawing-speed" class="table-of-contents__link toc-highlight">绘制速度</a></li></ul></li><li><a href="#touchgfx-limitations-with-serial-flash" class="table-of-contents__link toc-highlight">使用串行闪存时TouchGFX的限制</a><ul><li><a href="#texture-mapper" class="table-of-contents__link toc-highlight">纹理映射器</a></li><li><a href="#bitmap-painter" class="table-of-contents__link toc-highlight">位图绘制器</a></li><li><a href="#l8-palette" class="table-of-contents__link toc-highlight">L8调色板</a></li></ul></li><li><a href="#drivers" class="table-of-contents__link toc-highlight">驱动</a><ul><li><a href="#display" class="table-of-contents__link toc-highlight">显示屏</a></li><li><a href="#external-flash" class="table-of-contents__link toc-highlight">外部闪存</a></li><li><a href="#buttons" class="table-of-contents__link toc-highlight">按钮</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">All rights reserved © 2022 STMicroelectronics | <a href="https://www.st.com/content/st_com/en/common/terms-of-use.html">Terms of use</a> | <a href="https://www.st.com/content/st_com/en/common/privacy-policy.html">Privacy Policy</a> | <a href="/docs/miscellaneous/cookie-policy">Cookie Policy</a> | <a href="https://app-de.onetrust.com/app/#/webform/2b87200d-4023-4588-9df7-ab0cdea1a67e">Exercise your rights</a></div></div></div></footer></div></div>
<script src="/4.21/zh-CN/assets/js/runtime~main.1202490c.js"></script>
<script src="/4.21/zh-CN/assets/js/main.8eee2a9c.js"></script>
</body>
</html>