<!doctype html>
<html lang="zh-CN" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-development/touchgfx-hal-development/scenarios/scenarios-video-decoding">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.1">
<link rel="search" type="application/opensearchdescription+xml" title="TouchGFX Documentation" href="/4.21/zh-CN/opensearch.xml">
<script src="/4.21/zh-CN/js/one-trust.js"></script>
<script src="/4.21/js/fix-location.js"></script><title data-rh="true">视频解码 | TouchGFX Documentation</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://support.touchgfx.com/4.21/zh-CN/img/meta-image.png"><meta data-rh="true" name="twitter:image" content="https://support.touchgfx.com/4.21/zh-CN/img/meta-image.png"><meta data-rh="true" property="og:url" content="https://support.touchgfx.com/4.21/zh-CN/docs/development/touchgfx-hal-development/scenarios/scenarios-video-decoding"><meta data-rh="true" name="docusaurus_locale" content="zh-CN"><meta data-rh="true" name="docsearch:language" content="zh-CN"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="视频解码 | TouchGFX Documentation"><link data-rh="true" rel="icon" href="/4.21/zh-CN/img/favicon.png"><link data-rh="true" rel="canonical" href="https://support.touchgfx.com/4.21/zh-CN/docs/development/touchgfx-hal-development/scenarios/scenarios-video-decoding"><link data-rh="true" rel="alternate" href="https://support.touchgfx.com/4.21/docs/development/touchgfx-hal-development/scenarios/scenarios-video-decoding" hreflang="en"><link data-rh="true" rel="alternate" href="https://support.touchgfx.com/4.21/ko/docs/development/touchgfx-hal-development/scenarios/scenarios-video-decoding" hreflang="ko"><link data-rh="true" rel="alternate" href="https://support.touchgfx.com/4.21/ja/docs/development/touchgfx-hal-development/scenarios/scenarios-video-decoding" hreflang="ja"><link data-rh="true" rel="alternate" href="https://support.touchgfx.com/4.21/zh-CN/docs/development/touchgfx-hal-development/scenarios/scenarios-video-decoding" hreflang="zh-CN"><link data-rh="true" rel="alternate" href="https://support.touchgfx.com/4.21/zh-TW/docs/development/touchgfx-hal-development/scenarios/scenarios-video-decoding" hreflang="zh-TW"><link data-rh="true" rel="alternate" href="https://support.touchgfx.com/4.21/docs/development/touchgfx-hal-development/scenarios/scenarios-video-decoding" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://B8LNOI0XWD-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/4.21/zh-CN/assets/css/styles.3ea4e563.css">
<link rel="preload" href="/4.21/zh-CN/assets/js/runtime~main.e8e95dde.js" as="script">
<link rel="preload" href="/4.21/zh-CN/assets/js/main.25f79b43.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><div role="region"><a href="#" class="skipToContent_fXgn">跳转到主要内容</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" target="_self" href="/4.21/zh-CN/docs/introduction/welcome"><div class="navbar__logo"><img src="/4.21/zh-CN/img/logo.svg" alt="TouchGFX" class="themedImage_ToTc themedImage--light_HNdA"><img src="/4.21/zh-CN/img/logo.svg" alt="TouchGFX" class="themedImage_ToTc themedImage--dark_i4oU"></div></a><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">简体中文</a><ul class="dropdown__menu"><li><a href="/4.21/docs/development/touchgfx-hal-development/scenarios/scenarios-video-decoding" target="_self" rel="noopener noreferrer" class="dropdown__link">English</a></li><li><a href="/4.21/ko/docs/development/touchgfx-hal-development/scenarios/scenarios-video-decoding" target="_self" rel="noopener noreferrer" class="dropdown__link">한국어</a></li><li><a href="/4.21/ja/docs/development/touchgfx-hal-development/scenarios/scenarios-video-decoding" target="_self" rel="noopener noreferrer" class="dropdown__link">日本語</a></li><li><a href="/4.21/zh-CN/docs/development/touchgfx-hal-development/scenarios/scenarios-video-decoding" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active">简体中文</a></li><li><a href="/4.21/zh-TW/docs/development/touchgfx-hal-development/scenarios/scenarios-video-decoding" target="_self" rel="noopener noreferrer" class="dropdown__link">繁體中文</a></li></ul></div></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class="navbar__link" aria-haspopup="true" aria-expanded="false" role="button" href="/4.21/zh-CN/docs/introduction/welcome">4.21</a><ul class="dropdown__menu"><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/4.21/zh-CN/docs/development/touchgfx-hal-development/scenarios/scenarios-video-decoding">4.21</a></li><li><a href="https://support.touchgfx.com/4.21" target="_blank" rel="noopener noreferrer" class="dropdown__link">4.21<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a href="https://support.touchgfx.com/4.20" target="_blank" rel="noopener noreferrer" class="dropdown__link">4.20<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a href="https://support.touchgfx.com/4.19" target="_blank" rel="noopener noreferrer" class="dropdown__link">4.19<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a href="https://support.touchgfx.com/4.18" target="_blank" rel="noopener noreferrer" class="dropdown__link">4.18<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a href="https://support.touchgfx.com/4.17" target="_blank" rel="noopener noreferrer" class="dropdown__link">4.17<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a href="https://support.touchgfx.com/4.16" target="_blank" rel="noopener noreferrer" class="dropdown__link">4.16<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a href="https://support.touchgfx.com/4.15" target="_blank" rel="noopener noreferrer" class="dropdown__link">4.15<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a href="https://support.touchgfx.com/4.14" target="_blank" rel="noopener noreferrer" class="dropdown__link">4.14<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a href="https://support.touchgfx.com/4.13" target="_blank" rel="noopener noreferrer" class="dropdown__link">4.13<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><a href="https://community.st.com/s/topic/0TO0X0000003iw6WAA/touchgfx" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">社区</a><a href="https://touchgfx.com/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">TouchGFX.com</a><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="搜索"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">搜索</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="滚动返回顶部" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd"><nav class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/4.21/zh-CN/docs/category/introduction">介绍</a><button aria-label="切换可折叠边栏类别“介绍”" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/4.21/zh-CN/docs/category/basic-concepts">基本概念</a><button aria-label="切换可折叠边栏类别“基本概念”" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/4.21/zh-CN/docs/development/development-introduction">开发</a><button aria-label="切换可折叠边栏类别“开发”" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/4.21/zh-CN/docs/development/hardware-selection/hardware-selection-introduction">硬件选择</a><button aria-label="切换可折叠边栏类别“硬件选择”" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/4.21/zh-CN/docs/development/board-bring-up/board-introduction">驱动板卡</a><button aria-label="切换可折叠边栏类别“驱动板卡”" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" tabindex="0" href="/4.21/zh-CN/docs/development/touchgfx-hal-development/touchgfx-al-development-introduction">TouchGFX AL开发</a><button aria-label="切换可折叠边栏类别“TouchGFX AL开发”" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/4.21/zh-CN/docs/development/touchgfx-hal-development/touchgfx-architecture">抽象层架构</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/4.21/zh-CN/docs/category/generator-user-guide">Generator User Guide</a><button aria-label="切换可折叠边栏类别“Generator User Guide”" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" tabindex="0" href="/4.21/zh-CN/docs/category/scenarios">场景</a><button aria-label="切换可折叠边栏类别“场景”" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/4.21/zh-CN/docs/development/touchgfx-hal-development/scenarios/scenarios-ltdc-parallel-rgb">LTDC/并行RGB</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/4.21/zh-CN/docs/development/touchgfx-hal-development/scenarios/scenarios-fmc">FMC和SPI显示接口</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/4.21/zh-CN/docs/development/touchgfx-hal-development/scenarios/scenarios-framebuffer-strategies">帧缓存策略</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/4.21/zh-CN/docs/development/touchgfx-hal-development/scenarios/scenarios-configure-rtos">Real Time Operating System</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/4.21/zh-CN/docs/development/touchgfx-hal-development/scenarios/scenarios-video-decoding">视频解码</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/4.21/zh-CN/docs/development/touchgfx-hal-development/scenarios/scenarios-dsi-video-mode">MIPI-DSI视频模式</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/4.21/zh-CN/docs/development/touchgfx-hal-development/scenarios/scenarios-measure-performance">Performance Measurement</a></li></ul></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/4.21/zh-CN/docs/development/ui-development/ui-development-introduction">UI开发</a><button aria-label="切换可折叠边栏类别“UI开发”" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/4.21/zh-CN/docs/category/scenarios-2">场景</a><button aria-label="切换可折叠边栏类别“场景”" type="button" class="clean-btn menu__caret"></button></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/4.21/zh-CN/docs/category/miscellaneous-1">其他情况</a><button aria-label="切换可折叠边栏类别“其他情况”" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/4.21/zh-CN/docs/category/tutorials">指导</a><button aria-label="切换可折叠边栏类别“指导”" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/4.21/zh-CN/docs/api/classes/classtouchgfx_1_1_abstract_button">API</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/4.21/zh-CN/docs/category/resources">资源</a><button aria-label="切换可折叠边栏类别“资源”" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/4.21/zh-CN/docs/development/development-introduction"><span itemprop="name">开发</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/4.21/zh-CN/docs/development/touchgfx-hal-development/touchgfx-al-development-introduction"><span itemprop="name">TouchGFX AL开发</span></a><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/4.21/zh-CN/docs/category/scenarios"><span itemprop="name">场景</span></a><meta itemprop="position" content="3"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">视频解码</span><meta itemprop="position" content="4"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">在当前页面</button></div><div class="theme-doc-markdown markdown"><header><h1>视频解码</h1></header><p>This section shows how to configure the <a href="/4.21/zh-CN/docs/development/touchgfx-hal-development/generator-how-to/touchgfx-al-configuration/video-decoding">TouchGFX Generator</a> to generate a TouchGFX HAL that has video decoding capabilities.</p><p>在了解该场景之前，请阅读关于在TouchGFX中使用<a href="/4.21/zh-CN/docs/development/ui-development/touchgfx-engine-features/video">MJPEG视频</a>的文档和关于<a href="/4.21/zh-CN/docs/development/ui-development/ui-components/miscellaneous/video">视频控件</a>本身的文档。</p><p>以下场景详细说明了如何赋能TouchGFX HAL，以通过软件（LibJPEG）或硬件（JPEG）支持视频解码。 它涵盖STM32F7和STM32H7，因为在STM32CubeMX配置中，支持硬件（JPEG）解码时，STM32H7的配置与STM32F7略有不同。</p><p>Be sure to <strong>read all sections</strong> in this article before configuring the MCU for your specific project.</p><p>Generally, the LibJPEG and JPEG configurations can be found in STM32CubeMX in the <em>Middleware</em> and <em>Multimedia</em> catagories:</p><div class="figure noshadow"><a href="/4.21/zh-CN/img/development/touchgfx-hal-development/scenarios/cubemx-jpeg-configuration.webp" target="_blank"><img width="250" src="/4.21/zh-CN/img/development/touchgfx-hal-development/scenarios/cubemx-jpeg-configuration.webp"></a><p>JPEG and LibJPEG setting in STM32CubeMX</p></div><div class="highlight highlight-tip"><div class="highlight-heading"><h5><div class="highlight-icon"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></div>Tip</h5></div><div class="highlight-content"><li>最新版本的STM32H750-DK、STM32F769-DISCO和STM32F746G-DISCO TouchGFX硬件模板（TBS）通过各自的STM32CubeMX配置支持软件和JPEG硬件解码。</li><li>Use the STM32CubeMX configurations found in these example projects as inspiration to get your specific MCU to support MJPEG Video Decoding.</li></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="video-rtos-support">支持RTOS<a class="hash-link" href="#video-rtos-support" title="直接链接到标题">​</a></h2><p>The <a href="/4.21/zh-CN/docs/development/touchgfx-hal-development/generator-how-to/touchgfx-al-configuration/video-decoding">Generator User Guide</a> mentions that <em>Single-</em> and <em>Double buffer</em> decoding strategies require a CMSIS compliant RTOS, such as FreeRTOS. TouchGFX Generator generates an entry point function <code>videoTaskFunc()</code>, that must be associated with a Video decoding task. STM32CubeMX can generate this configuration by defining the task and entry point function in the <em>Tasks and queues</em> tab of the <em>FreeRTOS</em> Middleware configuration.</p><p>The video task stack size (defined in words for CMSIS V2) and RTOS heap size are two important factors.</p><p>For software decoding the stack size must be carefully set because LibJPEG uses dynamic memory allocation. For hardware decoding the stack size can be substantially lower because there is no software stack which dynamically allocates memory.</p><p>FreeRTOS堆对于您的一般应用 +<code> 0xA000</code>应该足够大。</p><div class="figure noshadow"><a href="/4.21/zh-CN/img/development/touchgfx-hal-development/scenarios/freertos-video-task.webp" target="_blank"><img width="600" src="/4.21/zh-CN/img/development/touchgfx-hal-development/scenarios/freertos-video-task.webp"></a><p>FreeRTOS任务配置</p></div><div class="figure noshadow"><a href="/4.21/zh-CN/img/development/touchgfx-hal-development/scenarios/freertos-video-decoding-heap-size.webp" target="_blank"><img width="600" src="/4.21/zh-CN/img/development/touchgfx-hal-development/scenarios/freertos-video-decoding-heap-size.webp"></a><p>FreeRTOS堆大小配置</p></div><p>Based on the above configuration, STM32CubeMX generates the following code for the video task:</p><div class="code-header"><div><h5>main.c</h5></div></div><div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/* Definitions for VideoTask */</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#bfc7d5"><span class="token plain">osThreadId_t VideoTaskHandle</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> osThreadAttr_t VideoTask_attributes </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">name </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;VideoTask&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">stack_size </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">1000</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">*</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">4</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">priority </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">osPriority_t</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> osPriorityLow</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">void</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">main</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/* creation of VideoTask */</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#bfc7d5"><span class="token plain">    VideoTaskHandle </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">osThreadNew</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">videoTaskFunc</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token constant" style="color:rgb(130, 170, 255)">NULL</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">&amp;</span><span class="token plain">VideoTask_attributes</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="code-header"><div><h5>FreeRTOSConfig.h</h5></div></div><div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token macro property directive-hash">#</span><span class="token macro property directive keyword" style="font-style:italic">define</span><span class="token macro property"> </span><span class="token macro property macro-name">configTOTAL_HEAP_SIZE</span><span class="token macro property">                    </span><span class="token macro property expression punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token macro property expression punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token macro property expression">size_t</span><span class="token macro property expression punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token macro property expression number" style="color:rgb(247, 140, 108)">75000</span><span class="token macro property expression punctuation" style="color:rgb(199, 146, 234)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="software-decoding">软件解码<a class="hash-link" href="#software-decoding" title="直接链接到标题">​</a></h2><p>The software decoding solution requires that the <strong>LibJPEG</strong> middleware is enabled from STM32CubeMX, as specified in <a href="/4.21/zh-CN/docs/development/touchgfx-hal-development/generator-how-to/touchgfx-al-configuration/video-decoding#video-decoding-type">Generator User Guide</a>. 软件解码设置对于所有具备LibJPEG功能的MCU（如STM32F4、STM32F7、STM32H7）都是相同的。</p><p>TouchGFX软件解码器期望LibJPEG解码的数据按照BGR像素排序。 如果该设置保留为RGB，R和B颜色分量将在应用中互换。</p><p>Furthermore, the size of each pixel should be 3 bytes if using a 16-bit or 24-bit video RGB buffer or 4 if using a 32-bit video RGB buffer.</p><div class="figure noshadow"><a href="/4.21/zh-CN/img/development/touchgfx-hal-development/scenarios/libjpeg-configuration.webp" target="_blank"><img width="500" src="/4.21/zh-CN/img/development/touchgfx-hal-development/scenarios/libjpeg-configuration.webp"></a><p>LibJPEG Configuration for a 16-bit or 24-bit video RGB buffer</p></div><div class="highlight highlight-caution"><div class="highlight-heading"><h5><div class="highlight-icon"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></div>Caution</h5></div><div class="highlight-content"><li>The RGB_ORDERING setting must be configured as BGR, and the pixel size must be set according to which video RGB buffer format is used.</li><li>If your application uses <b>Direct to Framebuffer</b> strategy in a <b>ARGB8888</b> (32-bit) application the <b>pixel size</b> must be set to 4</li></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="video-data">视频数据<a class="hash-link" href="#video-data" title="直接链接到标题">​</a></h3><div class="highlight highlight-caution"><div class="highlight-heading"><h5><div class="highlight-icon"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></div>Caution</h5></div><div class="highlight-content">当前解码解决方案（使用STM32CubeMX、TouchGFX Generator、以及来自TouchGFX Designer的视频控件）目前只适用于意法半导体开发板，因为在应用程序链接时，视频数据被链接到内存映射的flash中已知的特定地址。</div></div><p>下面来自EWARM项目的代码片段显示了由TouchGFX设计器创建的额外选项，以及它如何将数据放在<code>ExtFlashSection</code>中，后者是在所有TouchGFX板级包的链接器脚本中定义的。 这不适用于非内存映射的flash或未定义此部分的项目。</p><div class="code-header"><div><h5>ewarm_project.ewp</h5></div></div><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">        &lt;option&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          &lt;name&gt;IlinkExtraOptions&lt;/name&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          &lt;state&gt;--image_input $PROJ_DIR$\..\TouchGFX\generated\videos\bin\washerdryer.bin,video_washerdryer_bin_start,ExtFlashSection,4&lt;/state&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          &lt;state&gt;--keep video_washerdryer_bin_start&lt;/state&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        &lt;/option&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>对于视频数据位于非内存映射的flash中的项目，请阅读本文中的<code>FileReader</code>部分。</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="hardware-decoding">硬件解码<a class="hash-link" href="#hardware-decoding" title="直接链接到标题">​</a></h2><p>The <a href="/4.21/zh-CN/docs/development/touchgfx-hal-development/generator-how-to/touchgfx-al-configuration/video-decoding">Generator User Guide</a> mentions that the <strong>JPEG IP</strong> must be enabled in STM32CubeMX to enable Hardware decoding.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="stm32f769-disco">STM32F769-DISCO<a class="hash-link" href="#stm32f769-disco" title="直接链接到标题">​</a></h3><p>支持JPEG功能的STM32F7系列（例如STM32F769）的JPEG配置，与STM32H7系列略有不同。 The <code>RGB_FORMAT</code> setting found in the <em>JPEG</em> configurations must respect the pixel format of the TouchGFX Framebuffer, <code>JPEG_RGB565</code> in the example below.</p><div class="figure noshadow"><a href="/4.21/zh-CN/img/development/touchgfx-hal-development/scenarios/jpeg-hw-configuration.webp" target="_blank"><img width="450" src="/4.21/zh-CN/img/development/touchgfx-hal-development/scenarios/jpeg-hw-configuration.webp"></a><p>JPEG参数设置</p></div><p>Use DMA to transfer data to (memory-to-peripheral) and from (peripheral-to-memory) the JPEG peripheral through the <em>DMA Settings</em> tab found in <em>JPEG</em> configurations. 为<code>IN</code>和<code>OUT</code>各<em>添加</em>一个DMA请求将自动设置方向参数。</p><div class="figure noshadow"><a href="/4.21/zh-CN/img/development/touchgfx-hal-development/scenarios/jpeg-hw-dma-configuration.webp" target="_blank"><img width="450" src="/4.21/zh-CN/img/development/touchgfx-hal-development/scenarios/jpeg-hw-dma-configuration.webp"></a><p>JPEG DMA设置</p></div><p>本节总结了支持JPEG功能的STM32F7（例如STM32F769）上使用硬件解码时TouchGFX HAL的配置。 从STM32CubeMX生成代码后，在从Designer使用视频控件时，应用程序将能够使用JPEG外设解码视频。</p><div class="highlight highlight-caution"><div class="highlight-heading"><h5><div class="highlight-icon"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></div>Caution</h5></div><div class="highlight-content">JPEG外设配置的RGB_FORMAT必须遵守TouchGFX Framebuffer的格式</div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="stm32h750-dk">STM32H750-DK<a class="hash-link" href="#stm32h750-dk" title="直接链接到标题">​</a></h3><p>唯一能将（例如）STM32H750和STM32F769上的硬件解码（支持JPEG）加以区分的因素是在STM32CubeMX中配置DMA传输的方式。 不仅UI不同，DMA概念也不同。</p><p>对于STM32H750，JPEG外设只能配置为使用MDMA外设（而不是常规DMA外设）。 为输入和输出FIFO阈值信号添加MDMA配置，如下图所示。</p><div class="highlight highlight-note"><div class="highlight-heading"><h5><div class="highlight-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></div>Note</h5></div><div class="highlight-content">与DMA1/DMA2相比，MDMA是性能高很多的DMA引擎</div></div><div class="figure noshadow"><a href="/4.21/zh-CN/img/development/touchgfx-hal-development/scenarios/mdma-input-fifo-threshold.webp" target="_blank"><img src="/4.21/zh-CN/img/development/touchgfx-hal-development/scenarios/mdma-input-fifo-threshold.webp"></a><p>JPEG DMA设置</p></div><div class="figure noshadow"><a href="/4.21/zh-CN/img/development/touchgfx-hal-development/scenarios/mdma-output-fifo-threshold.webp" target="_blank"><img src="/4.21/zh-CN/img/development/touchgfx-hal-development/scenarios/mdma-output-fifo-threshold.webp"></a><p>JPEG DMA设置</p></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="filereader-interface"><code>FileReader</code>接口<a class="hash-link" href="#filereader-interface" title="直接链接到标题">​</a></h2><p>当在非内存映射的存储器中存储MJPEG视频时，开发人员可以指定<code>touchgfx::VideoDataReader</code>的实现，TouchGFX视频控制器可以使用它将需要解码的数据传输到配置的解码器（软件/硬件）。 下面是此接口的简单示例，它将视频数据从一个缓冲区复制到另一个缓冲区。</p><div class="code-header"><div><h5>VideoView.cpp</h5></div></div><div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">class</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(255, 203, 107)">MyReader</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token base-clause keyword" style="font-style:italic">public</span><span class="token base-clause"> touchgfx</span><span class="token base-clause double-colon punctuation" style="color:rgb(199, 146, 234)">::</span><span class="token base-clause class-name" style="color:rgb(255, 203, 107)">VideoDataReader</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">public</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token function" style="color:rgb(130, 170, 255)">MyReader</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">position</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">virtual</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">uint32_t</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">getDataLength</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">return</span><span class="token plain"> video_len</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">virtual</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">void</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">seek</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token keyword" style="font-style:italic">uint32_t</span><span class="token plain"> pos</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"> position </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> pos</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">virtual</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">bool</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">readData</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token keyword" style="font-style:italic">void</span><span class="token operator" style="color:rgb(137, 221, 255)">*</span><span class="token plain"> dst</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">uint32_t</span><span class="token plain"> bytes</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token function" style="color:rgb(130, 170, 255)">memcpy</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">dst</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">&amp;</span><span class="token plain">video_data</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">position</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> bytes</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        position </span><span class="token operator" style="color:rgb(137, 221, 255)">+=</span><span class="token plain"> bytes</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token keyword" style="font-style:italic">return</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">true</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">private</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token keyword" style="font-style:italic">uint32_t</span><span class="token plain"> position</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"> myReader</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>开发人员可以配置控件以使用数据读取器，而不是将一个<code>Video</code>控件指向映射内存中的视频开始部分：</p><div class="code-header"><div><h5>VideoView.cpp</h5></div></div><div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">video</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token function" style="color:rgb(130, 170, 255)">setVideoData</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">myReader</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="migrating-tbs-to-support-video-decoding">迁移TBS，以支持视频解码<a class="hash-link" href="#migrating-tbs-to-support-video-decoding" title="直接链接到标题">​</a></h2><p>If you want to migrate a project created from a TouchGFX Board Setups (TBS) - with a MCU that supports video decoding - from a version of TouchGFX Designer before video decoding was supported and you want to be able to use &#x27;Run Target&#x27; in TouchGFX Designer with that project, some manual changes to the GCC Makefile are required.</p><p>以下部分将列出所需的变更、以及进行变更的原因。 There are some general changes that must always be applied and some LibJPEG (software decoding) and JPEG (hardware decoding) specific changes depending on what the developers application uses. 这些更改是对旧TBS中已经存在的GCC Makefile的扩展。</p><p>如上述场景所述，除了更新Makefile，您还必须在STM32CubeMX中设置视频解码。</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="general-changes">General changes<a class="hash-link" href="#general-changes" title="直接链接到标题">​</a></h3><p>定义您项目中的LIBJPEG路径：</p><div class="language-make codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-make codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain"># LibJPEG path</span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#bfc7d5"><span class="token plain">libjpeg_path := $(cubemx_middlewares_path)/Third_Party/LibJPEG</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>然后必须定义视频资源输入路径：</p><div class="language-make codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-make codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">asset_texts_input  := TouchGFX/assets/texts</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#bfc7d5"><span class="token plain">asset_videos_input := TouchGFX/assets/videos</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The video assets output path must also be defined bellow the already existing assets output paths:</p><div class="language-make codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-make codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">asset_images_output := $(asset_root_path)/images</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">asset_fonts_output := $(asset_root_path)/fonts</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">asset_texts_output := $(asset_root_path)/texts</span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#bfc7d5"><span class="token plain">asset_videos_output := $(asset_root_path)/videos</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>将视频输出资源添加到组件列表中：</p><div class="language-make codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-make codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">all_components := $(components) \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    $(asset_fonts_output) \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    $(asset_images_output) \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    $(asset_texts_output)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    $(asset_texts_output) \</span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#bfc7d5"><span class="token plain">    $(asset_videos_output)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>必须定义视频对象文件。 The video object files are separated from the already existing object:</p><div class="language-make codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-make codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">c_source_files := $(call find, $(source_paths),*.c) $(os_source_files) $(board_c_files)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">source_files += $(board_cpp_files)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#bfc7d5"><span class="token plain">video_object_files := $(call find, $(asset_videos_output),*.o)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>必须定义视频转换器脚本的路径：</p><div class="language-make codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-make codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">textconvert_script_path := $(touchgfx_path)/framework/tools/textconvert</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">textconvert_executable := $(call find, $(textconvert_script_path), *.rb)</span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#bfc7d5"><span class="token plain">videoconvert_script_path := $(touchgfx_path)/framework/tools/videoconvert</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>An optional <code>echo</code> can be added to see all video objects files. 视频对象文件必须添加到链接阶段。 该行将$(video_object_files)和其他对象文件加在一起：</p><div class="language-make codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-make codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">$(binary_output_path)/$(target_executable): $(object_files) $(object_asm_files)</span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#bfc7d5"><span class="token plain">    @echo Video Objects: $(video_object_files)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @echo Linking $(@)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @mkdir -p $(@D)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @mkdir -p $(object_output_path)</span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#bfc7d5"><span class="token plain">    @$(file &gt;$(build_root_path)/objects.tmp) $(foreach F,$(object_files) $(video_object_files),$(file &gt;&gt;$(build_root_path)/objects.tmp,$F))</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>将视频规则添加到现有<em>资源</em>和.PHONY：</p><div class="language-make codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-make codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line theme-code-block-highlighted-line" style="color:#bfc7d5"><span class="token plain">_assets_: BitmapDatabase TextKeysAndLanguages Videos</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#bfc7d5"><span class="token plain">.PHONY: BitmapDatabase TextKeysAndLanguages Videos</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>添加视频转换后，接着添加视频规则：</p><div class="language-make codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-make codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">Videos:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @ruby $(videoconvert_script_path)/videoconvert.rb $(asset_videos_input) $(asset_videos_output)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>最后更新清除规则，也删除与视频相关的输出。</p><div class="language-make codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-make codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">_clean_:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @echo Cleaning: $(board_name)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @rm -rf $(build_root_path)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    # Do not remove gui_generated</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @rm -rf $(asset_images_output)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @rm -rf $(asset_fonts_output)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @rm -rf $(asset_texts_output)</span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#bfc7d5"><span class="token plain">    @rm -rf $(asset_videos_output)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    # Create directory to avoid error if it does not exist</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @mkdir -p $(asset_root_path)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    # Remove assets folder if it is empty (i.e. no gui_generated folder)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @rmdir --ignore-fail-on-non-empty $(asset_root_path)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    # Clean bootloader project</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @$(MAKE) -r -f ExtMem_Boot/gcc/Makefile -s $(MFLAGS) clean</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="software-changes">软件变化<a class="hash-link" href="#software-changes" title="直接链接到标题">​</a></h3><p>添加所有LIBJPEG路径到include路径：</p><div class="language-make codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-make codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">include_paths := $(library_includes) \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    $(foreach comp, $(all_components), $(comp)/include) \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    $(foreach comp, $(cubemx_components), $(comp)/Inc) \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    $(foreach comp, $(touchgfx_generator_components), $(comp)/generated) \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    $(framework_includes) \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    $(cubemx_middlewares_path) \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    $(touchgfx_middlewares_path) \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    $(touchgfx_generator_components) \</span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#bfc7d5"><span class="token plain">    LIBJPEG/Target \</span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#bfc7d5"><span class="token plain">    $(libjpeg_path)/include \</span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#bfc7d5"><span class="token plain">    LIBJPEG/App</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>必须定义LIBJPEG源路径：</p><div class="language-make codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-make codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">c_source_files := $(call find, $(source_paths),*.c) $(os_source_files) $(board_c_files)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">source_files += $(board_cpp_files)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#bfc7d5"><span class="token plain">libjpeg_source_path = Middlewares/Third_Party/LibJPEG/source</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>接下来，所有LIBJPEG源文件必须添加到board_c_files：</p><div class="language-make codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-make codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">board_c_files := \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    $(Drivers_path)/BSP/STM32H750B-DK/stm32h750b_discovery_bus.c \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    $(Drivers_path)/BSP/STM32H750B-DK/stm32h750b_discovery_qspi.c \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    $(Drivers_path)/BSP/STM32H750B-DK/stm32h750b_discovery_sdram.c \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    $(Drivers_path)/BSP/STM32H750B-DK/stm32h750b_discovery_ts.c \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    $(Drivers_path)/BSP/Components/ft5336/ft5336.c \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    $(Drivers_path)/BSP/Components/ft5336/ft5336_reg.c \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    $(Drivers_path)/BSP/Components/mt25tl01g/mt25tl01g.c \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    $(Drivers_path)/BSP/Components/mt48lc4m32b2/mt48lc4m32b2.c \</span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#bfc7d5"><span class="token plain">    $(libjpeg_source_path)/jaricom.c \</span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#bfc7d5"><span class="token plain">    $(libjpeg_source_path)/jcomapi.c \</span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#bfc7d5"><span class="token plain">    $(libjpeg_source_path)/jdapimin.c \</span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#bfc7d5"><span class="token plain">    $(libjpeg_source_path)/jdapistd.c \</span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#bfc7d5"><span class="token plain">    $(libjpeg_source_path)/jdarith.c \</span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#bfc7d5"><span class="token plain">    $(libjpeg_source_path)/jdatasrc.c \</span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#bfc7d5"><span class="token plain">    $(libjpeg_source_path)/jdcoefct.c \</span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#bfc7d5"><span class="token plain">    $(libjpeg_source_path)/jdcolor.c \</span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#bfc7d5"><span class="token plain">    $(libjpeg_source_path)/jddctmgr.c \</span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#bfc7d5"><span class="token plain">    $(libjpeg_source_path)/jdhuff.c \</span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#bfc7d5"><span class="token plain">    $(libjpeg_source_path)/jdinput.c \</span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#bfc7d5"><span class="token plain">    $(libjpeg_source_path)/jdmainct.c \</span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#bfc7d5"><span class="token plain">    $(libjpeg_source_path)/jdmarker.c \</span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#bfc7d5"><span class="token plain">    $(libjpeg_source_path)/jdmaster.c \</span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#bfc7d5"><span class="token plain">    $(libjpeg_source_path)/jdmerge.c \</span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#bfc7d5"><span class="token plain">    $(libjpeg_source_path)/jdpostct.c \</span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#bfc7d5"><span class="token plain">    $(libjpeg_source_path)/jdsample.c \</span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#bfc7d5"><span class="token plain">    $(libjpeg_source_path)/jdtrans.c \</span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#bfc7d5"><span class="token plain">    $(libjpeg_source_path)/jerror.c \</span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#bfc7d5"><span class="token plain">    $(libjpeg_source_path)/jidctflt.c \</span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#bfc7d5"><span class="token plain">    $(libjpeg_source_path)/jidctfst.c \</span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#bfc7d5"><span class="token plain">    $(libjpeg_source_path)/jidctint.c \</span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#bfc7d5"><span class="token plain">    $(libjpeg_source_path)/jmemmgr.c \</span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#bfc7d5"><span class="token plain">    $(libjpeg_source_path)/jmemnobs.c \</span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#bfc7d5"><span class="token plain">    $(libjpeg_source_path)/jquant1.c \</span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#bfc7d5"><span class="token plain">    $(libjpeg_source_path)/jquant2.c \</span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#bfc7d5"><span class="token plain">    $(libjpeg_source_path)/jutils.c \</span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#bfc7d5"><span class="token plain">    LIBJPEG/App/libjpeg.c</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>然后将LIBJPEG源文件添加到现有的目标文件中，方法与其他中间件源文件相同：</p><div class="language-make codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-make codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Start converting paths</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">object_files := $(object_files:$(touchgfx_path)/%.cpp=$(object_output_path)/touchgfx/%.o)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">object_files := $(object_files:%.cpp=$(object_output_path)/%.o)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">object_files := $(object_files:$(touchgfx_middlewares_path)/%.c=$(object_output_path)/$(touchgfx_middlewares_path)/%.o)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">object_files := $(object_files:$(cubemx_middlewares_path)/%.c=$(object_output_path)/$(cubemx_middlewares_path)/%.o)</span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#bfc7d5"><span class="token plain">object_files := $(object_files:$(libjpeg_source_path)/%.c=$(object_output_path)/$(libjpeg_source_path)/%.o)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">object_files := $(object_files:$(Drivers_path)/%.c=$(object_output_path)/Drivers/%.o)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">object_files := $(object_files:%.c=$(object_output_path)/%.o)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="hardware-changes">硬件变化<a class="hash-link" href="#hardware-changes" title="直接链接到标题">​</a></h3><p>添加所有JPEG路径到include 路径：</p><div class="language-make codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-make codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">include_paths := $(library_includes) \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    $(foreach comp, $(all_components), $(comp)/include) \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    $(foreach comp, $(cubemx_components), $(comp)/Inc) \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    $(foreach comp, $(touchgfx_generator_components), $(comp)/generated) \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    $(framework_includes) \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    $(cubemx_middlewares_path) \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    $(touchgfx_middlewares_path) \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    $(touchgfx_generator_components) \</span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#bfc7d5"><span class="token plain">    Utilities/JPEG</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>接下来，所有JPEG源文件必须添加到board_c_files：</p><div class="language-make codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-make codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">board_c_files := \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    $(Drivers_path)/BSP/STM32H750B-DK/stm32h750b_discovery_bus.c \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    $(Drivers_path)/BSP/STM32H750B-DK/stm32h750b_discovery_qspi.c \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    $(Drivers_path)/BSP/STM32H750B-DK/stm32h750b_discovery_sdram.c \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    $(Drivers_path)/BSP/STM32H750B-DK/stm32h750b_discovery_ts.c \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    $(Drivers_path)/BSP/Components/ft5336/ft5336.c \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    $(Drivers_path)/BSP/Components/ft5336/ft5336_reg.c \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    $(Drivers_path)/BSP/Components/mt25tl01g/mt25tl01g.c \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    $(Drivers_path)/BSP/Components/mt48lc4m32b2/mt48lc4m32b2.c \</span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#bfc7d5"><span class="token plain">    Utilities/JPEG/jpeg_utils.c</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="placing-video-buffer-in-external-memory">将视频缓冲区置于外部存储器中<a class="hash-link" href="#placing-video-buffer-in-external-memory" title="直接链接到标题">​</a></h2><p>When developers create new projects with STM32CubeMX, the linker scripts associated with the generated projects do not contain any of the possible regions used by TouchGFX. 因此，用于解码MJPEG视频的特定缓冲区被链接器放置在内部flash中，直至开发人员修改他们的链接器脚本，将缓冲区放置到其他地方。 如果没有这样的修改，开发人员将会遇到大量内部存储被使用的情况，可能无法容纳大一点的视频缓冲区，比如全屏视频解码所需的缓冲区。</p><div class="highlight highlight-tip"><div class="highlight-heading"><h5><div class="highlight-icon"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></div>Tip</h5></div><div class="highlight-content">以下TBS是预先配置好的，可以从外部存储解码视频：<ol><li>STM32F746-DISCO</li><li>STM32F769-DISCO</li><li>STM32H750-DK</li></ol></div></div><p>启用视频解码以后，TouchGFX Generator生成用于JPEG解码的RGB缓冲区的定义。 该定义是用一个位置指示来实现的，它告诉链接器应该将缓冲区放在哪个部分。 如果链接器在链接器脚本中找不到该存储区域，缓冲区将被放在内部存储中。</p><div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">LOCATION_PRAGMA_NOLOAD</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;Video_RGB_Buffer&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">uint32_t</span><span class="token plain"> videoRGBBuffer</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token number" style="color:rgb(247, 140, 108)">57600</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">LOCATION_ATTRIBUTE_NOLOAD</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;Video_RGB_Buffer&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>下面特定于编译器的子章节描述了开发人员可以进行的修改，以实现在SDRAM中放置缓冲区。 <code>Video_RGB_Buffer</code>表示用于视频解码的缓冲区。 链接器脚本示例在SDRAM中为TouchGFX帧缓存区保留了一些空间（从0x<code>C0000000</code>开始）。</p><ol><li>EWARM</li><li>STM32CubeIDE</li><li>MDK-ARM</li></ol><div class="highlight highlight-further-reading"><div class="highlight-heading"><h5><div class="highlight-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></div>Further reading</h5></div><div class="highlight-content">Please read the section in the <a href="/4.21/zh-CN/docs/development/touchgfx-hal-development/generator-how-to/touchgfx-al-configuration/video-decoding">Generator User Guide</a>  on configuring a project for Video Decoding.</div></div><p>下面的例子都在STM32F746G-DISCO板（<code>0xC0000000</code>-&gt;&gt;<code>0xC00FF000</code>）上的SDRAM开始部分保留了一些空间，允许应用程序通过地址（例如<code>0xC0000000</code>）引用帧缓存区，而不存在链接器覆盖帧缓存区数据的风险。 每个示例都允许链接器将<code>Video_RGB_Buffer</code>放入已定义的SDRAM区域。</p><div class="highlight highlight-tip"><div class="highlight-heading"><h5><div class="highlight-icon"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></div>Tip</h5></div><div class="highlight-content">如果你分配Touchgfx帧缓存区，而不是使用直接寻址，那么你的链接器脚本也应该将<b>TouchGFX_Framebuffer</b>放入SDRAM中。</div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="ewarm-iar">EWARM (IAR)<a class="hash-link" href="#ewarm-iar" title="直接链接到标题">​</a></h3><div class="code-header"><div><h5>stm32f746xx_flash.icf</h5></div></div><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">define symbol __ICFEDIT_region_SDRAM_start__   = 0xC00FF000;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">define symbol __ICFEDIT_region_SDRAM_end__     = 0xC0700FFF;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">define region SDRAM_region    = mem:[from __ICFEDIT_region_SDRAM_start__ to __ICFEDIT_region_SDRAM_end__];</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">place in SDRAM_region    { first section Video_RGB_Buffer };</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>链接之后，<code>EWARM\STM32F746G_DISCO\List\STM32F746G_DISCO.map</code>包含<code>Video_RGB_Buffer</code>的以下放置信息：</p><div class="code-header"><div><h5>STM32F746G_DISCO.map</h5></div></div><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">Video_RGB_Buffer        zero     0xc00f&#x27;f000   0x3&#x27;8400  TouchGFXGeneratedHAL.o [2]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                               - 0xc013&#x27;7400   0x3&#x27;8400</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="stm32cubeide">STM32CubeIDE<a class="hash-link" href="#stm32cubeide" title="直接链接到标题">​</a></h3><div class="code-header"><div><h5>STM32F746NGHX_FLASH.ld</h5></div></div><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">MEMORY</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">{</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  ...</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  SDRAM      (xrw)    : ORIGIN = 0xC00FF000,   LENGTH = 8M</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">BufferSection (NOLOAD) :</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">{</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  *(Video_RGB_Buffer Video_RGB_Buffer.*)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  *(.gnu.linkonce.r.*)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  . = ALIGN(0x4);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">} &gt;SDRAM</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>编译之后，<code>STM32CubeIDE\Debug\STM32F746G_DISCO.map</code> 包含<code>Video_RGB_Buffer</code>的以下放置信息：</p><div class="code-header"><div><h5>STM32F746G_DISCO.map</h5></div></div><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">BufferSection   0x00000000c00ff000    0x1c200</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> *(Video_RGB_Buffer Video_RGB_Buffer.*)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> Video_RGB_Buffer</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                0x00000000c00ff000    0x1c200 Application/User/TouchGFX/target/generated/TouchGFXGeneratedHAL.o</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                0x00000000c00ff000                videoRGBBuffer</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="mdk-arm-keil">MDK-ARM (Keil)<a class="hash-link" href="#mdk-arm-keil" title="直接链接到标题">​</a></h3><div class="code-header"><div><h5>STM32F746G_DISCO.sct</h5></div></div><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">LR_IROM1 0x08000000 0x00200000  {    ; load region size_region</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  ER_IROM1 0x08000000 0x00200000  {  ; load address = execution address</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    *.o (RESET, +First)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    *(InRoot$$Sections)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    .ANY (+RO)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  RW_IRAM1 0x20000000 0x00050000  {  ; RW data</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    .ANY (+RW +ZI)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  RW_SDRAM 0xC00FF000 UNINIT 0xC0700FFF  {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    *.o (Video_RGB_Buffer)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Make sure to include the <code>UNINIT</code> attribute in the section that holds the Video Buffer. This ensures leaving the memory region as uninitialized data. 链接之后，<code>MDK-ARM\STM32F746G_DISCO\STM32F746G_DISCO.map</code>包含<code>Video_RGB_Buffer</code>的以下放置信息：</p><div class="code-header"><div><h5>STM32F746G_DISCO.map</h5></div></div><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">Video_RGB_Buffer                         0xc00ff000   Section    115200  touchgfxgeneratedhal.o(Video_RGB_Buffer)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="文档页面导航"><a class="pagination-nav__link pagination-nav__link--prev" href="/4.21/zh-CN/docs/development/touchgfx-hal-development/scenarios/scenarios-configure-rtos"><div class="pagination-nav__sublabel">上一个</div><div class="pagination-nav__label">Real Time Operating System</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/4.21/zh-CN/docs/development/touchgfx-hal-development/scenarios/scenarios-dsi-video-mode"><div class="pagination-nav__sublabel">下一个</div><div class="pagination-nav__label">MIPI-DSI视频模式</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#video-rtos-support" class="table-of-contents__link toc-highlight">支持RTOS</a></li><li><a href="#software-decoding" class="table-of-contents__link toc-highlight">软件解码</a><ul><li><a href="#video-data" class="table-of-contents__link toc-highlight">视频数据</a></li></ul></li><li><a href="#hardware-decoding" class="table-of-contents__link toc-highlight">硬件解码</a><ul><li><a href="#stm32f769-disco" class="table-of-contents__link toc-highlight">STM32F769-DISCO</a></li><li><a href="#stm32h750-dk" class="table-of-contents__link toc-highlight">STM32H750-DK</a></li></ul></li><li><a href="#filereader-interface" class="table-of-contents__link toc-highlight"><code>FileReader</code>接口</a></li><li><a href="#migrating-tbs-to-support-video-decoding" class="table-of-contents__link toc-highlight">迁移TBS，以支持视频解码</a><ul><li><a href="#general-changes" class="table-of-contents__link toc-highlight">General changes</a></li><li><a href="#software-changes" class="table-of-contents__link toc-highlight">软件变化</a></li><li><a href="#hardware-changes" class="table-of-contents__link toc-highlight">硬件变化</a></li></ul></li><li><a href="#placing-video-buffer-in-external-memory" class="table-of-contents__link toc-highlight">将视频缓冲区置于外部存储器中</a><ul><li><a href="#ewarm-iar" class="table-of-contents__link toc-highlight">EWARM (IAR)</a></li><li><a href="#stm32cubeide" class="table-of-contents__link toc-highlight">STM32CubeIDE</a></li><li><a href="#mdk-arm-keil" class="table-of-contents__link toc-highlight">MDK-ARM (Keil)</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">保留所有权利 © 2022 STMicroelectronics | <a href="https://www.st.com/content/st_com/en/common/terms-of-use.html">使用条款</a> | <a href="https://www.st.com/content/st_com/en/common/privacy-policy.html">隐私策略</a> | <a href="/docs/miscellaneous/cookie-policy">Cookie政策</a> | <a href="https://app-de.onetrust.com/app/#/webform/2b87200d-4023-4588-9df7-ab0cdea1a67e">行使您的权利</a></div></div></div></footer></div></div>
<script src="/4.21/zh-CN/assets/js/runtime~main.e8e95dde.js"></script>
<script src="/4.21/zh-CN/assets/js/main.25f79b43.js"></script>
</body>
</html>