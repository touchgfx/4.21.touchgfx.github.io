<!doctype html>
<html lang="zh-CN" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-development/touchgfx-hal-development/touchgfx-al-development-introduction">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.1">
<link rel="search" type="application/opensearchdescription+xml" title="TouchGFX Documentation" href="/4.21/zh-CN/opensearch.xml">
<script src="/4.21/zh-CN/js/one-trust.js"></script>
<script src="/4.21/js/fix-location.js"></script><title data-rh="true">TouchGFX开发简介 | TouchGFX Documentation</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://support.touchgfx.com/4.21/zh-CN/img/meta-image.png"><meta data-rh="true" name="twitter:image" content="https://support.touchgfx.com/4.21/zh-CN/img/meta-image.png"><meta data-rh="true" property="og:url" content="https://support.touchgfx.com/4.21/zh-CN/docs/development/touchgfx-hal-development/touchgfx-al-development-introduction"><meta data-rh="true" name="docusaurus_locale" content="zh-CN"><meta data-rh="true" name="docsearch:language" content="zh-CN"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="TouchGFX开发简介 | TouchGFX Documentation"><link data-rh="true" rel="icon" href="/4.21/zh-CN/img/favicon.png"><link data-rh="true" rel="canonical" href="https://support.touchgfx.com/4.21/zh-CN/docs/development/touchgfx-hal-development/touchgfx-al-development-introduction"><link data-rh="true" rel="alternate" href="https://support.touchgfx.com/4.21/docs/development/touchgfx-hal-development/touchgfx-al-development-introduction" hreflang="en"><link data-rh="true" rel="alternate" href="https://support.touchgfx.com/4.21/ko/docs/development/touchgfx-hal-development/touchgfx-al-development-introduction" hreflang="ko"><link data-rh="true" rel="alternate" href="https://support.touchgfx.com/4.21/ja/docs/development/touchgfx-hal-development/touchgfx-al-development-introduction" hreflang="ja"><link data-rh="true" rel="alternate" href="https://support.touchgfx.com/4.21/zh-CN/docs/development/touchgfx-hal-development/touchgfx-al-development-introduction" hreflang="zh-CN"><link data-rh="true" rel="alternate" href="https://support.touchgfx.com/4.21/zh-TW/docs/development/touchgfx-hal-development/touchgfx-al-development-introduction" hreflang="zh-TW"><link data-rh="true" rel="alternate" href="https://support.touchgfx.com/4.21/docs/development/touchgfx-hal-development/touchgfx-al-development-introduction" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://B8LNOI0XWD-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/4.21/zh-CN/assets/css/styles.2fc40eaa.css">
<link rel="preload" href="/4.21/zh-CN/assets/js/runtime~main.334fafd6.js" as="script">
<link rel="preload" href="/4.21/zh-CN/assets/js/main.ac793cb9.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><div role="region"><a href="#" class="skipToContent_fXgn">跳转到主要内容</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" target="_self" href="/4.21/zh-CN/docs/introduction/welcome"><div class="navbar__logo"><img src="/4.21/zh-CN/img/logo.svg" alt="TouchGFX" class="themedImage_ToTc themedImage--light_HNdA"><img src="/4.21/zh-CN/img/logo.svg" alt="TouchGFX" class="themedImage_ToTc themedImage--dark_i4oU"></div></a><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">简体中文</a><ul class="dropdown__menu"><li><a href="/4.21/docs/development/touchgfx-hal-development/touchgfx-al-development-introduction" target="_self" rel="noopener noreferrer" class="dropdown__link">English</a></li><li><a href="/4.21/ko/docs/development/touchgfx-hal-development/touchgfx-al-development-introduction" target="_self" rel="noopener noreferrer" class="dropdown__link">한국어</a></li><li><a href="/4.21/ja/docs/development/touchgfx-hal-development/touchgfx-al-development-introduction" target="_self" rel="noopener noreferrer" class="dropdown__link">日本語</a></li><li><a href="/4.21/zh-CN/docs/development/touchgfx-hal-development/touchgfx-al-development-introduction" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active">简体中文</a></li><li><a href="/4.21/zh-TW/docs/development/touchgfx-hal-development/touchgfx-al-development-introduction" target="_self" rel="noopener noreferrer" class="dropdown__link">繁體中文</a></li></ul></div></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class="navbar__link" aria-haspopup="true" aria-expanded="false" role="button" href="/4.21/zh-CN/docs/introduction/welcome">4.21</a><ul class="dropdown__menu"><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/4.21/zh-CN/docs/development/touchgfx-hal-development/touchgfx-al-development-introduction">4.21</a></li><li><a href="https://support.touchgfx.com/4.20" target="_blank" rel="noopener noreferrer" class="dropdown__link">4.20<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a href="https://support.touchgfx.com/4.19" target="_blank" rel="noopener noreferrer" class="dropdown__link">4.19<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a href="https://support.touchgfx.com/4.18" target="_blank" rel="noopener noreferrer" class="dropdown__link">4.18<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a href="https://support.touchgfx.com/4.17" target="_blank" rel="noopener noreferrer" class="dropdown__link">4.17<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a href="https://support.touchgfx.com/4.16" target="_blank" rel="noopener noreferrer" class="dropdown__link">4.16<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a href="https://support.touchgfx.com/4.15" target="_blank" rel="noopener noreferrer" class="dropdown__link">4.15<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a href="https://support.touchgfx.com/4.14" target="_blank" rel="noopener noreferrer" class="dropdown__link">4.14<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a href="https://support.touchgfx.com/4.13" target="_blank" rel="noopener noreferrer" class="dropdown__link">4.13<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><a href="https://community.st.com/s/topic/0TO0X0000003iw6WAA/touchgfx" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">社区</a><a href="https://touchgfx.com/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">TouchGFX.com</a><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="搜索"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">搜索</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd"><nav class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/4.21/zh-CN/docs/category/introduction">介绍</a><button aria-label="Toggle the collapsible sidebar category &#x27;介绍&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/4.21/zh-CN/docs/category/basic-concepts">基本概念</a><button aria-label="Toggle the collapsible sidebar category &#x27;基本概念&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/4.21/zh-CN/docs/development/development-introduction">开发</a><button aria-label="Toggle the collapsible sidebar category &#x27;开发&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/4.21/zh-CN/docs/development/hardware-selection/hardware-selection-introduction">硬件选择</a><button aria-label="Toggle the collapsible sidebar category &#x27;硬件选择&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/4.21/zh-CN/docs/development/board-bring-up/board-introduction">驱动板卡</a><button aria-label="Toggle the collapsible sidebar category &#x27;驱动板卡&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible menu__list-item-collapsible--active"><a class="menu__link menu__link--sublist menu__link--active" aria-current="page" aria-expanded="true" tabindex="0" href="/4.21/zh-CN/docs/development/touchgfx-hal-development/touchgfx-al-development-introduction">TouchGFX AL开发</a><button aria-label="Toggle the collapsible sidebar category &#x27;TouchGFX AL开发&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/4.21/zh-CN/docs/development/touchgfx-hal-development/touchgfx-architecture">抽象层架构</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/4.21/zh-CN/docs/category/generator-user-guide">Generator User Guide</a><button aria-label="Toggle the collapsible sidebar category &#x27;Generator User Guide&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/4.21/zh-CN/docs/category/scenarios">场景</a><button aria-label="Toggle the collapsible sidebar category &#x27;场景&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/4.21/zh-CN/docs/development/ui-development/ui-development-introduction">UI开发</a><button aria-label="Toggle the collapsible sidebar category &#x27;UI开发&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/4.21/zh-CN/docs/category/scenarios-2">场景</a><button aria-label="Toggle the collapsible sidebar category &#x27;场景&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/4.21/zh-CN/docs/category/miscellaneous-1">其他情况</a><button aria-label="Toggle the collapsible sidebar category &#x27;其他情况&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/4.21/zh-CN/docs/category/tutorials">指导</a><button aria-label="Toggle the collapsible sidebar category &#x27;指导&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/4.21/zh-CN/docs/api/classes/classtouchgfx_1_1_abstract_button">API</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/4.21/zh-CN/docs/category/resources">资源</a><button aria-label="Toggle the collapsible sidebar category &#x27;资源&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/4.21/zh-CN/docs/development/development-introduction"><span itemprop="name">开发</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">TouchGFX AL开发</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">在当前页面</button></div><div class="theme-doc-markdown markdown"><header><h1>TouchGFX开发简介</h1></header><div class="figure noshadow"><a href="/4.21/zh-CN/img/development/touchgfx-hal-development/activities-selected-002.webp" target="_blank"><img width="600" src="/4.21/zh-CN/img/development/touchgfx-hal-development/activities-selected-002.webp"></a><p>项目活动</p></div><p>The TouchGFX Abstraction Layer (AL), in a TouchGFX application, is the software component that sits between the Board Initialization Code, developed during the Board Bring-Up phase, and the TouchGFX Engine. Its main task is to tie together the Engine with the underlying hardware and operating system. This is done by abstracting the specifics of the underlying hardware and OS such that it can be treated in a unified way by the Engine.</p><p>AL由两个不同的部分组成，分别为硬件抽象层（HAL）和操作系统抽象层（OSAL）。</p><div class="figure noshadow"><a href="/4.21/zh-CN/img/development/touchgfx-hal-development/components-selected-002.webp" target="_blank"><img width="600" src="/4.21/zh-CN/img/development/touchgfx-hal-development/components-selected-002.webp"></a><p>项目组件</p></div><p>In this section you will get a general introduction to the principles and responsibilities of the abstraction layer and how it interacts with the TouchGFX Engine.</p><p>You will also get an introduction to the TouchGFX Generator. The TouchGFX Generator, a part of X-CUBE-TOUCHGFX, is <em>the</em> primary tool for the creation of the Abstraction Layer. It is an STM32CubeMX Additional-Software component that helps developers configure the TouchGFX AL to run on their hardware platform. Based on existing STM32CubeMX settings and user inputs, TouchGFX Generator will generate the files required to configure a working TouchGFX application. They include files for TouchGFX HAL, TouchGFX OSAL and TouchGFX Configuration.</p><p>In the following sections you will get an understanding of the general architecture of the TouchGFX AL. You will also find a <em>User Guide</em> on how to use TouchGFX Generator inside STM32CubeMX. Useful scenarios are also shown to help you with common use cases.</p><section class="row"><article class="col col--6 margin-bottom--lg"><a class="card padding--lg cardContainer_fWXF" href="/4.21/zh-CN/docs/development/touchgfx-hal-development/touchgfx-architecture"><h2 class="text--truncate cardTitle_rnsV" title="抽象层架构">📄️<!-- --> <!-- -->抽象层架构</h2></a></article><article class="col col--6 margin-bottom--lg"><a class="card padding--lg cardContainer_fWXF" href="/4.21/zh-CN/docs/category/generator-user-guide"><h2 class="text--truncate cardTitle_rnsV" title="Generator User Guide">🗃️<!-- --> <!-- -->Generator User Guide</h2><p class="text--truncate cardDescription_PWke" title="6 items">6 items</p></a></article><article class="col col--6 margin-bottom--lg"><a class="card padding--lg cardContainer_fWXF" href="/4.21/zh-CN/docs/category/scenarios"><h2 class="text--truncate cardTitle_rnsV" title="场景">🗃️<!-- --> <!-- -->场景</h2><p class="text--truncate cardDescription_PWke" title="7 items">7 items</p></a></article></section><h2 class="anchor anchorWithStickyNavbar_LWe7" id="responsibilities-of-the-abstraction-layer">抽象层的职责<a class="hash-link" href="#responsibilities-of-the-abstraction-layer" title="直接链接到标题">​</a></h2><p>如在基本概念章节中的<a href="/4.21/zh-CN/docs/basic-concepts/rendering">主循环</a>部分所述，TouchGFX Engine具有执行三个基本步骤的主循环。</p><ol><li>收集输入（触摸坐标、按钮）</li><li>更新场景模型</li><li>将场景模型渲染到帧缓存</li></ol><p>这三个步骤为履行TouchGFX Engine的主要职责提供了保障，即通过更新帧缓存来揭示应用程序的当前状态。</p><p>帧缓存数据到显示屏的实际传输以及对外部输入的收集并非由引擎直接处理，而后由引擎委托给TouchGFX AL实现。</p><p>主循环将反复不断地更新帧缓存数据。 此过程必须与实际更新频率和显示屏就绪状态保持同步，以确保所有帧均被传输并显示在显示屏上。 如果没有发生同步，则主循环将不断更新，并有可能在传输之前覆盖帧缓存。 此同步由AL负责。</p><p>TouchGFX AL还负责控制和访问帧缓冲存储区。 这意味着帧缓冲的所有访问都通过AL进行。</p><p>具体而言，TouchGFX AL的职责为：</p><table><thead><tr><th>职责</th><th>说明</th></tr></thead><tbody><tr><td>将TouchGFX Engine主循环与显示屏传输同步</td><td>当下一帧已计算并在可用的帧缓存中渲染时，引擎主循环必须停止，从而确保更新的帧缓存内容在被传输到显示屏之前不会被覆盖。</td></tr><tr><td>报告触摸与物理按钮事件</td><td>通过采样来确定触摸事件的发生及坐标信息的获取。 通过采样来确定物理按钮或类似部分是否被激活。 向引擎报告这些事件。 <br>请注意，可通过不同的机制将其他外部事件传播到TouchGFX应用程序。 在<a href="/4.21/zh-CN/docs/development/ui-development/touchgfx-engine-features/backend-communication">后端通信</a>章节了解有关该主题的更多信息。</td></tr><tr><td>同步帧缓冲访问</td><td>帧缓存由TouchGFX AL负责，由于它可能被不同的执行单元（如主循环线程和DMA）访问，TouchGFX AL必须提供一种保护该存储器的方式。</td></tr><tr><td>报告下一个可用的帧缓冲区</td><td>AL必须能够回答接下来可更新当前帧缓冲的哪一部分。 在标准的双帧缓冲设置中，始终有个完整的帧缓冲区，因为在这种情况下，始终有一个完整的帧缓冲区专用于渲染，另一个帧缓冲区用于到显示屏的传输。 在单帧缓存区或部分帧缓存设置中，情况更复杂。</td></tr><tr><td>执行渲染操作</td><td>在渲染场景模型时，引擎主循环请求AL渲染一部分。 特定TouchGFX AL实现将利用底层硬件来渲染图形基元。 一个示例使用Chrom-ART图形加速器来渲染MCU上的位图。 TouchGFX随附专为所有可用平台而构建的优化渲染方法，因此无需对其进行定制。</td></tr><tr><td>处理将帧缓冲传输到显示屏</td><td>引擎通知AL必须传输哪个帧缓冲的哪一部分。 AL启动此传输，确保像素最终出现在显示屏上。</td></tr></tbody></table><p>由于TouchGFX AL是一种没有自身线程或类似线程的被动软件模块，因此它必须通过从TouchGFX Engine主循环调用特定钩子（函数）或通过中断来执行其操作。</p><p>可用的钩子和中断集如下所述。</p><div class="figure noshadow"><a href="/4.21/zh-CN/img/development/touchgfx-hal-development/al-introduction/al-hooks-00.webp" target="_blank"><img src="/4.21/zh-CN/img/development/touchgfx-hal-development/al-introduction/al-hooks-00.webp"></a><p>可用的钩子和中断</p></div><p>由AL开发人员来实现这些钩子，以便在给定底层硬件和操作系统下体现AL的职能。 如果AL开发人员需要其他方法来支持职能，则开发人员可以设置中断，并在特定时刻激活。 这方面的示例通过硬件定时器结合LTDC场同步中断。 <em>显示就绪</em>中断为场同步中断的一个示例。 请注意，这些中断的设置被视为AL开发的一部分。</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="example-setup-two-framebuffers---mcu-with-ltdc">示例设置: 两个帧缓存并内置LTDC的MCU<a class="hash-link" href="#example-setup-two-framebuffers---mcu-with-ltdc" title="直接链接到标题">​</a></h2><p>一种常见设置是使用具有LTDC的MCU的两个帧缓存。 在该设置中，每个钩子的AL操作通常如下。</p><p>设置AL以响应LTDC VSYNC中断，以便显示屏每次准备接收新帧时都执行I1。 这用于将主循环与显示同步。</p><table><thead><tr><th>钩子和中断</th><th>动作</th></tr></thead><tbody><tr><td>I1: 显示就绪</td><td>设置LTDC VSYNC中断，以触发该操作。<br>取消阻塞主循环，并启动在上一帧中准备好的帧缓存数据传输</td></tr><tr><td>H1: 报告触摸与物理按钮事件</td><td>返回有关触摸事件或物理按钮单击的任何信息</td></tr><tr><td>H2: 获取下一个可用的帧缓冲区</td><td>使用双缓冲设置，只需返回当前未传输至显示屏的帧缓冲的整个帧缓冲区</td></tr><tr><td>H3: 执行渲染操作</td><td>取决于MCU的性能。 执行其余的硬件辅助渲染操作和软件回退</td></tr><tr><td>H4: 区域渲染完成</td><td>无操作</td></tr><tr><td>H5: 渲染完成</td><td>阻塞主循环</td></tr></tbody></table><p>此设置提供以下执行流程：</p><div class="figure noshadow"><a href="/4.21/zh-CN/img/development/touchgfx-hal-development/al-introduction/al-actions-00.webp" target="_blank"><img src="/4.21/zh-CN/img/development/touchgfx-hal-development/al-introduction/al-actions-00.webp"></a><p>使用两个帧缓存和带有LTDC的MCU的设置中的执行流程</p></div><p>这里描述了AL设置的总体设计。 以下各节深入介绍了如何实现抽象层。</p></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="文档页面导航"><a class="pagination-nav__link pagination-nav__link--prev" href="/4.21/zh-CN/docs/development/board-bring-up/how-to/11-flash-loader"><div class="pagination-nav__sublabel">上一个</div><div class="pagination-nav__label">11. 闪存下载</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/4.21/zh-CN/docs/development/touchgfx-hal-development/touchgfx-architecture"><div class="pagination-nav__sublabel">下一个</div><div class="pagination-nav__label">抽象层架构</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#responsibilities-of-the-abstraction-layer" class="table-of-contents__link toc-highlight">抽象层的职责</a></li><li><a href="#example-setup-two-framebuffers---mcu-with-ltdc" class="table-of-contents__link toc-highlight">示例设置: 两个帧缓存并内置LTDC的MCU</a></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">All rights reserved © 2022 STMicroelectronics | <a href="https://www.st.com/content/st_com/en/common/terms-of-use.html">Terms of use</a> | <a href="https://www.st.com/content/st_com/en/common/privacy-policy.html">Privacy Policy</a> | <a href="/docs/miscellaneous/cookie-policy">Cookie Policy</a> | <a href="https://app-de.onetrust.com/app/#/webform/2b87200d-4023-4588-9df7-ab0cdea1a67e">Exercise your rights</a></div></div></div></footer></div></div>
<script src="/4.21/zh-CN/assets/js/runtime~main.334fafd6.js"></script>
<script src="/4.21/zh-CN/assets/js/main.ac793cb9.js"></script>
</body>
</html>