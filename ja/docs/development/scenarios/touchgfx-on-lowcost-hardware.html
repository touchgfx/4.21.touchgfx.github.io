<!doctype html>
<html lang="ja" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-development/scenarios/touchgfx-on-lowcost-hardware">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.1">
<link rel="search" type="application/opensearchdescription+xml" title="TouchGFX Documentation" href="/4.21/ja/opensearch.xml">
<script src="/4.21/ja/js/one-trust.js"></script>
<script src="/4.21/js/fix-location.js"></script><title data-rh="true">低コスト･ハードウェア上のTouchGFX | TouchGFX Documentation</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://support.touchgfx.com/4.21/ja/img/meta-image.png"><meta data-rh="true" name="twitter:image" content="https://support.touchgfx.com/4.21/ja/img/meta-image.png"><meta data-rh="true" property="og:url" content="https://support.touchgfx.com/4.21/ja/docs/development/scenarios/touchgfx-on-lowcost-hardware"><meta data-rh="true" name="docusaurus_locale" content="ja"><meta data-rh="true" name="docsearch:language" content="ja"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="低コスト･ハードウェア上のTouchGFX | TouchGFX Documentation"><link data-rh="true" rel="icon" href="/4.21/ja/img/favicon.png"><link data-rh="true" rel="canonical" href="https://support.touchgfx.com/4.21/ja/docs/development/scenarios/touchgfx-on-lowcost-hardware"><link data-rh="true" rel="alternate" href="https://support.touchgfx.com/4.21/docs/development/scenarios/touchgfx-on-lowcost-hardware" hreflang="en"><link data-rh="true" rel="alternate" href="https://support.touchgfx.com/4.21/ko/docs/development/scenarios/touchgfx-on-lowcost-hardware" hreflang="ko"><link data-rh="true" rel="alternate" href="https://support.touchgfx.com/4.21/ja/docs/development/scenarios/touchgfx-on-lowcost-hardware" hreflang="ja"><link data-rh="true" rel="alternate" href="https://support.touchgfx.com/4.21/zh-CN/docs/development/scenarios/touchgfx-on-lowcost-hardware" hreflang="zh-CN"><link data-rh="true" rel="alternate" href="https://support.touchgfx.com/4.21/zh-TW/docs/development/scenarios/touchgfx-on-lowcost-hardware" hreflang="zh-TW"><link data-rh="true" rel="alternate" href="https://support.touchgfx.com/4.21/docs/development/scenarios/touchgfx-on-lowcost-hardware" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://B8LNOI0XWD-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/4.21/ja/assets/css/styles.2fc40eaa.css">
<link rel="preload" href="/4.21/ja/assets/js/runtime~main.acc27096.js" as="script">
<link rel="preload" href="/4.21/ja/assets/js/main.67dd044a.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><div role="region"><a href="#" class="skipToContent_fXgn">メイン･コンテンツまでスキップ</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" target="_self" href="/4.21/ja/docs/introduction/welcome"><div class="navbar__logo"><img src="/4.21/ja/img/logo.svg" alt="TouchGFX" class="themedImage_ToTc themedImage--light_HNdA"><img src="/4.21/ja/img/logo.svg" alt="TouchGFX" class="themedImage_ToTc themedImage--dark_i4oU"></div></a><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">日本語</a><ul class="dropdown__menu"><li><a href="/4.21/docs/development/scenarios/touchgfx-on-lowcost-hardware" target="_self" rel="noopener noreferrer" class="dropdown__link">English</a></li><li><a href="/4.21/ko/docs/development/scenarios/touchgfx-on-lowcost-hardware" target="_self" rel="noopener noreferrer" class="dropdown__link">한국어</a></li><li><a href="/4.21/ja/docs/development/scenarios/touchgfx-on-lowcost-hardware" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active">日本語</a></li><li><a href="/4.21/zh-CN/docs/development/scenarios/touchgfx-on-lowcost-hardware" target="_self" rel="noopener noreferrer" class="dropdown__link">简体中文</a></li><li><a href="/4.21/zh-TW/docs/development/scenarios/touchgfx-on-lowcost-hardware" target="_self" rel="noopener noreferrer" class="dropdown__link">繁體中文</a></li></ul></div></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class="navbar__link" aria-haspopup="true" aria-expanded="false" role="button" href="/4.21/ja/docs/introduction/welcome">4.21</a><ul class="dropdown__menu"><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/4.21/ja/docs/development/scenarios/touchgfx-on-lowcost-hardware">4.21</a></li><li><a href="https://support.touchgfx.com/4.20" target="_blank" rel="noopener noreferrer" class="dropdown__link">4.20<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a href="https://support.touchgfx.com/4.19" target="_blank" rel="noopener noreferrer" class="dropdown__link">4.19<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a href="https://support.touchgfx.com/4.18" target="_blank" rel="noopener noreferrer" class="dropdown__link">4.18<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a href="https://support.touchgfx.com/4.17" target="_blank" rel="noopener noreferrer" class="dropdown__link">4.17<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a href="https://support.touchgfx.com/4.16" target="_blank" rel="noopener noreferrer" class="dropdown__link">4.16<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a href="https://support.touchgfx.com/4.15" target="_blank" rel="noopener noreferrer" class="dropdown__link">4.15<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a href="https://support.touchgfx.com/4.14" target="_blank" rel="noopener noreferrer" class="dropdown__link">4.14<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a href="https://support.touchgfx.com/4.13" target="_blank" rel="noopener noreferrer" class="dropdown__link">4.13<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><a href="https://community.st.com/s/topic/0TO0X0000003iw6WAA/touchgfx" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">コミュニティ</a><a href="https://touchgfx.com/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">TouchGFX.com</a><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="検索"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">検索</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="上へスクロールしてもどる" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd"><nav class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/4.21/ja/docs/category/introduction">概要</a><button aria-label="折りたたみ可能なサイドバーのカテゴリ&#x27;概要&#x27;を切り替える" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/4.21/ja/docs/category/basic-concepts">基本概念</a><button aria-label="折りたたみ可能なサイドバーのカテゴリ&#x27;基本概念&#x27;を切り替える" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/4.21/ja/docs/development/development-introduction">開発</a><button aria-label="折りたたみ可能なサイドバーのカテゴリ&#x27;開発&#x27;を切り替える" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/4.21/ja/docs/development/hardware-selection/hardware-selection-introduction">ハードウェアの選択</a><button aria-label="折りたたみ可能なサイドバーのカテゴリ&#x27;ハードウェアの選択&#x27;を切り替える" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/4.21/ja/docs/development/board-bring-up/board-introduction">ボード立ち上げ</a><button aria-label="折りたたみ可能なサイドバーのカテゴリ&#x27;ボード立ち上げ&#x27;を切り替える" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/4.21/ja/docs/development/touchgfx-hal-development/touchgfx-al-development-introduction">TouchGFX AL（抽象化レイヤ）開発</a><button aria-label="折りたたみ可能なサイドバーのカテゴリ&#x27;TouchGFX AL（抽象化レイヤ）開発&#x27;を切り替える" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/4.21/ja/docs/development/ui-development/ui-development-introduction">UI開発</a><button aria-label="折りたたみ可能なサイドバーのカテゴリ&#x27;UI開発&#x27;を切り替える" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" tabindex="0" href="/4.21/ja/docs/category/scenarios-2">シナリオ</a><button aria-label="折りたたみ可能なサイドバーのカテゴリ&#x27;シナリオ&#x27;を切り替える" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/4.21/ja/docs/development/scenarios/touchgfx-on-lowcost-hardware">低コスト･ハードウェア上のTouchGFX</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/4.21/ja/docs/development/scenarios/touchgfx-on-gpu2d">NeoChrom上のTouchGFX</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/4.21/ja/docs/development/scenarios/lowering-memory-usage-with-partial-framebuffer">パーシャル･フレームバッファによるメモリ使用量の軽減</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/4.21/ja/docs/development/scenarios/using-non-memory-mapped-flash">画像保存のために非メモリ･マップドFlashを使用</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/4.21/ja/docs/development/scenarios/using-serial-flash">画像とフォント用にシリアルFlashの使用</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/4.21/ja/docs/development/scenarios/fonts-in-unmapped-flash">フォント･データ用に非メモリ･マップドFlashを使用</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/4.21/ja/docs/development/scenarios/scenarios-change-pixelformat-bpp">アプリケーションのピクセル･フォーマットの変更</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/4.21/ja/docs/development/scenarios/scenarios-create-at">TouchGFXボード設定の作成</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/4.21/ja/docs/development/scenarios/example-gpio">トリガとしての外部イベント</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/4.21/ja/docs/development/scenarios/running-without-rtos">TouchGFX Board SetupでRTOSを使用せずに実行</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/4.21/ja/docs/development/scenarios/adding-files-to-stm32cubemx-projet">STM32CubeMXプロジェクトへのファイルの追加</a></li></ul></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/4.21/ja/docs/category/miscellaneous-1">その他</a><button aria-label="折りたたみ可能なサイドバーのカテゴリ&#x27;その他&#x27;を切り替える" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/4.21/ja/docs/category/tutorials">チュートリアル</a><button aria-label="折りたたみ可能なサイドバーのカテゴリ&#x27;チュートリアル&#x27;を切り替える" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/4.21/ja/docs/api/classes/classtouchgfx_1_1_abstract_button">API</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/4.21/ja/docs/category/resources">リソース</a><button aria-label="折りたたみ可能なサイドバーのカテゴリ&#x27;リソース&#x27;を切り替える" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/4.21/ja/docs/development/development-introduction"><span itemprop="name">開発</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/4.21/ja/docs/category/scenarios-2"><span itemprop="name">シナリオ</span></a><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">低コスト･ハードウェア上のTouchGFX</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">このページでは</button></div><div class="theme-doc-markdown markdown"><header><h1>低コスト･ハードウェア上のTouchGFX</h1></header><p>このセクションでは、RAMやFlashの搭載量が制限され、アクセラレーション機能がなく、外部FlashやディスプレイへのSPI接続が低速である低コスト･ハードウェア上でTouchGFXを使用する方法について説明します。</p><p>また、与えられたハードウェアで最適なアプリケーションを作成するための、いくつかアドバイスを提示したいと思います。</p><p>このセクションを通して、ハードウェア例として、X-Nucleo-GFX01M1拡張ボード付きSTM32G071 Nucleoボード向けのTouchGFXボード設定を使用します。 この拡張ボードには16ビット･ディスプレイとシリアルFlashが搭載されています。</p><div class="figure"><a href="/4.21/ja/img/development/ui-development/scenarios/lowering-memory-usage-with-partial-framebuffer/g071-with-gfx01m1.webp" target="_blank"><img src="/4.21/ja/img/development/ui-development/scenarios/lowering-memory-usage-with-partial-framebuffer/g071-with-gfx01m1.webp"></a><p>X-Nucleo-GFX01M1拡張ボード付きのNucleo-G071RB</p></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="hardware-overview">ハードウェアの概要<a class="hash-link" href="#hardware-overview" title="見出しに直接リンク">​</a></h2><p>このキットのハードウェア構成は、STM32G071マイクロコントローラ、SPI NOR Flash、SPIディスプレイ、ジョイスティック･ボタンから成り立っています。</p><table><thead><tr><th><strong>コンポーネント</strong></th><th align="right"> </th></tr></thead><tbody><tr><td>マイクロコントローラ</td><td align="right">STM32G071RB</td></tr><tr><td>マイクロコントローラ内蔵RAM</td><td align="right">32KB</td></tr><tr><td>マイクロコントローラ内蔵Flash</td><td align="right">128KB</td></tr><tr><td>ディスプレイ</td><td align="right">Displaytech DT022CTFT</td></tr><tr><td>ディスプレイ解像度</td><td align="right">240x320</td></tr><tr><td>ディスプレイ･フォーマット</td><td align="right">16ビットRGB565</td></tr><tr><td>ディスプレイ･コントローラ</td><td align="right">ILI9341V</td></tr><tr><td>ディスプレイ接続</td><td align="right">SPI</td></tr><tr><td>ディスプレイ接続速度</td><td align="right">32MHz</td></tr><tr><td>NOR Flash</td><td align="right">Macronix MX25L6433F</td></tr><tr><td>NOR Flashサイズ</td><td align="right">64Mbit</td></tr><tr><td>NOR Flash接続速度</td><td align="right">32MHz</td></tr></tbody></table><p>ディスプレイはSPI1ペリフェラルに、FlashはSPI2ペリフェラルに接続されています。 これにより、マイクロコントローラはデータをディスプレイに転送中に、Flashからデータを読み込むことができます。</p><div class="figure"><a href="/4.21/ja/img/development/scenarios/touchgfx-on-lowcost-hardware/g071-gfx01m1-architecture.webp" target="_blank"><img width="500px" src="/4.21/ja/img/development/scenarios/touchgfx-on-lowcost-hardware/g071-gfx01m1-architecture.webp"></a><p>X-Nucleo-GFX01M1を接続したNucleo-G071RBの構成</p></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="gpio-allocation">GPIO割り当て<a class="hash-link" href="#gpio-allocation" title="見出しに直接リンク">​</a></h3><table><thead><tr><th><strong>信号</strong></th><th><strong>GPIOピン</strong></th></tr></thead><tbody><tr><td>ディスプレイCS</td><td>PB5</td></tr><tr><td>ディスプレイDCX</td><td>PB3</td></tr><tr><td>ディスプレイSCK</td><td>PA5</td></tr><tr><td>ディスプレイMOSI</td><td>PA7</td></tr><tr><td>ディスプレイTE</td><td>PA0</td></tr><tr><td>Flash CS</td><td>PB9</td></tr><tr><td>Flash SCK</td><td>PB13</td></tr><tr><td>Flash MOSI</td><td>PC3</td></tr><tr><td>Flash MISO</td><td>PC2</td></tr></tbody></table><p>上のテーブルは、Flashおよびディスプレイへの信号のGPIO割り当てを示しています。 これらの信号は、オシロスコープまたはロジック･アナライザを使用してモニタできます。 これはパフォーマンスに関する問題などのデバッグ時に非常に役立ちます。</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="starting-a-project">プロジェクトの開始<a class="hash-link" href="#starting-a-project" title="見出しに直接リンク">​</a></h3><p>STM32G071RB Nucleo評価キットのプロジェクトは、TouchGFX Designerで簡単に開始できます。 &quot;Create New&quot;ボタンをクリックして、STM32G071 Nucleoを検索します。  このボード設定は、X-Nucleo-GFX01M1ディスプレイ･シールド付きのNucleo-G071RBキット用に特に開発されたものです。</p><div class="figure"><a href="/4.21/ja/img/development/scenarios/touchgfx-on-lowcost-hardware/g071-start-new-project-4.17.webp" target="_blank"><img src="/4.21/ja/img/development/scenarios/touchgfx-on-lowcost-hardware/g071-start-new-project-4.17.webp"></a><p>Nucleo-G071RBの新しいプロジェクト</p></div><p>TouchGFXボード設定は、NOR Flash、ディスプレイ、ボタンをサポートします。 ディスプレイは縦向きと横向きの両方のモードで使用できます。</p><p>ディスプレイの向きは、TouchGFX DesignerのConfig -&gt; Displayセクションで変更できます。</p><div class="figure"><a href="/4.21/ja/img/development/scenarios/touchgfx-on-lowcost-hardware/portrait-4.17.webp" target="_blank"><img src="/4.21/ja/img/development/scenarios/touchgfx-on-lowcost-hardware/portrait-4.17.webp"></a><p>ディスプレイの向きを縦または横に選択</p></div><p>X-Nucleo-GFX01M1シールドのディスプレイは、元々は縦向き（幅より高さの方が長い）ですが、横向きでも簡単に使用できます。</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="display-updates">ディスプレイの更新<a class="hash-link" href="#display-updates" title="見出しに直接リンク">​</a></h2><p>上に示したディスプレイの解像度は240x320ピクセルです。 合計で76,800ピクセル（153,600バイト）です。 マイクロコントローラとディスプレイ間の接続はSPI、32MHzです。 これにより、4MB/秒（2Mピクセル/秒）の転送が可能になります。</p><p>ディスプレイのリフレッシュ･レートは76.1Hzで、これにより1フレームあたり13.14msのフレーム時間となります。</p><div class="figure"><a href="/4.21/ja/img/development/scenarios/touchgfx-on-lowcost-hardware/display-te.webp" target="_blank"><img src="/4.21/ja/img/development/scenarios/touchgfx-on-lowcost-hardware/display-te.webp"></a><p>ディスプレイからのティアリング効果信号</p></div><p>つまり、次のフレーム用のデータ転送にかけられる時間は、長くて13ms程度ということです。 この時間内で、200万ピクセル/秒 / 76 fps = 26,280ピクセル/フレーム（または、フル･スクリーンの34%）を転送できます。 実際には、プロトコル･オーバーヘッドのために、SPIバス上でこの転送速度を維持することはできないので、フレーム全体の約30%以上を送信することは期待できません。</p><p>アプリケーションの更新がこのピクセル量を超える場合、ハードウェアはフレーム時間内に転送を完了できません。 その結果、ディスプレイには更新全体が完了する前に、更新中のフレームが表示されることになります。 このため、古いフレームと新しいフレームが混じった状態で表示される場合があります。</p><p>この現象は、一部のアニメーションではユーザにとって目立つものではありませんが、特定のアプリケーションでは受け入れがたいものとなります。</p><p>このためSTでは、更新のレベルを30%未満に抑えることを推奨しています。 たとえば、 フレームの更新を少しずつ行う方法です。</p><p>このことから、一般的にはアイテムの移動よりも画面上でアイテムを展開する方がうまくいきます。</p><div class="figure"><a href="/4.21/ja/img/development/scenarios/touchgfx-on-lowcost-hardware/star.webp" target="_blank"><img width="400" src="/4.21/ja/img/development/scenarios/touchgfx-on-lowcost-hardware/star.webp"></a><p>ディスプレイからのティアリング効果信号</p></div><p>星を右側に移動する場合は、その星によってカバーされているすべてのピクセルを更新する必要があります。 星を展開する場合には、新しいピクセルのみを更新する必要があります。 前のフレームで更新されたピクセルは変更されずにそのまま残ります。</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="drawing-speed">描画速度<a class="hash-link" href="#drawing-speed" title="見出しに直接リンク">​</a></h3><p>ディスプレイへの転送は、最大32MHzで実行されます。</p><p>シリアルFlashはディスプレイと同じ転送速度で動作できます。 つまり、シリアルFlashには、ディスプレイに最大速度でビットを転送するための十分な速度があるということです。</p><p>これは、Flash内の画像のピクセル･フォーマットがRGB565である場合にのみ成り立ちます。 この場合は、Flashからの2バイトの読み取りが1ピクセルに相当し、ディスプレイ上でも2バイトになります。 Flash内のピクセル･フォーマットがARGB8888の場合、ディスプレイ上で1ピクセルを生成するにはFlashから2倍の量のデータを読み取る必要があり、シリアルFlashはディスプレイに追いつけなくなります。</p><p>この場合、ディスプレイにデータが連続的に転送されなくなり、1フレームでディスプレイの30%を完全に更新することが不可能となります。 可能な解決法の1つは、画像を内蔵Flashに移動することで、もう1つは当然ながらピクセル･フォーマットを変更することです。</p><p>その他のウィジェットはFlashの速度に縛られません。 たとえば、 色の付いた長方形を描画するボックス･ウィジェットがあります。 もちろんこのウィジェットは非常に高速で、ディスプレイの転送速度を大きく上回っています。 ラインやサークルなどのその他のウィジェットは、CPUリソースを非常に多く使用します。 これらのウィジェットでは、ディスプレイに転送可能な速度でピクセルを生成することができません。 これらのウィジェットを使用する場合、アプリケーションは、すべてのフレームでディスプレイの30%を更新することを期待できません。</p><p>ピクセルのレンダリングの複雑さについては、<a href="/4.21/ja/docs/basic-concepts/performance#the-complexity-of-rendering-the-pixels">こちら</a>をご覧ください。</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="touchgfx-limitations-with-serial-flash">シリアルFlash搭載のTouchGFXの制限事項<a class="hash-link" href="#touchgfx-limitations-with-serial-flash" title="見出しに直接リンク">​</a></h2><p>シリアルFlashを搭載したSTM32G0上のTouchGFXには、アプリケーション･プログラマが注意する必要のあるいくつかの制限事項があります。</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="texture-mapper">テクスチャ･マッパー<a class="hash-link" href="#texture-mapper" title="見出しに直接リンク">​</a></h3><p>テクスチャ･マッパー･ウィジェット（Texture Mapper、Animation Texture Mapper、Scalable Image）では、外部SPI Flashに保存される画像を描画できません。 シリアルFlashに保存されている画像を使用した画像回転などでは、許容可能な性能を得ることができないからです。</p><p>テクスチャ･マッパーで画像を使用するには、その画像を内蔵FlashまたはRAMに保存する必要があります。 TouchGFX Designerで画像設定を変更すれば、簡単に画像を内部Flashに保存できます。</p><p>Imagesタブに移動して、画像を選択します。 ウィンドウの右側で、&quot;Section&quot;属性を&quot;IntFlashSection&quot;に変更します。</p><div class="figure"><a href="/4.21/ja/img/development/scenarios/touchgfx-on-lowcost-hardware/image-internal-4.17.webp" target="_blank"><img src="/4.21/ja/img/development/scenarios/touchgfx-on-lowcost-hardware/image-internal-4.17.webp"></a><p>画像を内蔵Flashに配置</p></div><p>テクスチャ･マッパー･コードは大きすぎるので、すべてのプロジェクトに含めることができません。 このため、STM32G0プロジェクトではデフォルトで無効化されています。 つまり、テクスチャ･マッパーをSTM32G0プロジェクトで使用するには、使用前に有効化する必要があります。</p><p>&quot;Config&quot;タブに移動して、&quot;Framework Features&quot;を選択し、関連するテクスチャ･マッパーまたはテクスチャ･マッパーのグループをクリックします。</p><div class="figure"><a href="/4.21/ja/img/development/scenarios/touchgfx-on-lowcost-hardware/enabling-texture-mapper-4.17.webp" target="_blank"><img src="/4.21/ja/img/development/scenarios/touchgfx-on-lowcost-hardware/enabling-texture-mapper-4.17.webp"></a><p>特定の画像フォーマットに対してテクスチャ･マッパーを有効化</p></div><p><a href="/4.21/ja/docs/development/ui-development/touchgfx-engine-features/caching-bitmaps">Bitmap Cache</a>を使用して、画像を一時的にRAMに移動することもできます。</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="bitmap-painter">ビットマップ･ペインタ<a class="hash-link" href="#bitmap-painter" title="見出しに直接リンク">​</a></h3><p>ライン、サークル、ダイナミック･グラフのウィジェットでは、画像に色付けできます。 ただし、SPI Flashにある画像ではこれはできません。 これらのウィジェットで使用する画像は、内蔵FlashまたはRAMに配置する必要があります。</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="l8-palette">L8パレット<a class="hash-link" href="#l8-palette" title="見出しに直接リンク">​</a></h3><p>L8フォーマットの画像をシリアルFlash搭載のハードウェアで使用できます。 ただし、パレット･データを内蔵Flashに配置する必要があるという制限があります（これも性能上の理由です）。</p><p>パレットを内蔵Flashに移動するには、TouchGFX Designerで&quot;Extra Section&quot;を&quot;IntFlashSection&quot;に変更します。</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="drivers">ドライバ<a class="hash-link" href="#drivers" title="見出しに直接リンク">​</a></h2><p>TouchGFXボード設定はTouchGFX Generatorを使用して作成します。 Read more about the Generator <a href="/4.21/ja/docs/development/touchgfx-hal-development/generator-how-to/enabling-touchgfx-generator">here</a>. TouchGFX GeneratorはHALレイヤを生成します。HALレイヤは、TouchGFXフレームワークを一連のローレベル･ドライバ（このTouchGFXボード設定ですでに実装済み）とリンクさせます。 このアプリケーション･テンプレートのローレベル･ドライバは、ユーザのプロジェクトの<code>Core/Src</code>フォルダにあります。</p><p>ドライバは、次の3つのファイルの中にあります。</p><table><thead><tr><th><strong>ドライバ</strong></th><th><strong>ファイル</strong></th></tr></thead><tbody><tr><td>ディスプレイ</td><td>Core/Src/MB1642BDisplayDriver.c</td></tr><tr><td>Flash</td><td>Core/Src/MB1642BDataReader.c</td></tr><tr><td>ボタン</td><td>Core/Src/MB1642BButtonController.cpp</td></tr></tbody></table><h3 class="anchor anchorWithStickyNavbar_LWe7" id="display">ディスプレイ<a class="hash-link" href="#display" title="見出しに直接リンク">​</a></h3><p>ディスプレイではごく標準的なSPIプロトコルが使用されます。 いくつかのレジスタは、ディスプレイを設定するために書き込むことが可能です。 データをディスプレイに転送するときに、チップ･セレクトがアサートされます。 その他のGPIOやDCXは、コマンド･バイトとデータ･バイトを区別するために使用されます。</p><p>ドライバはDMAチャネルを使用して、ディスプレイのピクセル･データを転送します。 これにより、マイクロコントローラがピクセルを計算中でも、データを転送することができます。 DMA完了の割込みを使用して、今後の描画での再利用のために伝送済みのメモリを開放したり、新しいデータがすでに用意されていれば転送を再開したりします。</p><p>設定データはDMAでは送られません。このディスプレイのプロトコルに応じて、小型パッケージ間（またはパッケージ内）でCSピンとCDXピンを切り替える必要があるからです。</p><p>ドライバは設定データの送信時には8bitモードでSPIを使用しますが、ピクセル･データの転送時には16bitモードに変更します。 これは、マイクロコントローラのメモリがリトル･エンディアン･モードで読み出されるからです。 RGB565フォーマットのピクセルは、最初に下位バイト（GおよびB）が、2番目に上位バイト（RおよびG）がRAMに保存されます。 この順序は、8bit SPIが転送のためにメモリを読み取るときにも保持されます。 SPIが16bitモードの場合、データはメモリから16bit RGB565として読み取られ、ディスプレイにとって正しい順序で転送されます。</p><p>16bit DMAを使用しないドライバは、転送前にピクセル内のバイトをスワップする必要があります。</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="initialization">初期化<a class="hash-link" href="#initialization" title="見出しに直接リンク">​</a></h4><p>ディスプレイの初期化は、<code>MB1642BDisplayDriver_DisplayInit(void)</code>という関数にあります。</p><p>ドライバは6つのコマンドをディスプレイに送信しますが、これは推奨されるパワー･オン･シーケンスに従っています。</p><ol><li>Sleep Mode（11h）を終了する</li><li>Normal Mode（13h）に入る</li><li>MXおよびBGRビットを使用して、Memory Access Control（36h）を設定する</li><li>16bitフォーマットで、Pixel Format（3Ah）を設定する</li><li>Tearing Effect Line On（35h）</li><li>ライン = 0で、Tear Scanline（44h）を設定する</li></ol><p>これらのコマンドの間に、ドライバは100msスリープします。</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="tearing-effect">ティアリング効果<a class="hash-link" href="#tearing-effect" title="見出しに直接リンク">​</a></h4><p>ディスプレイからのティアリング効果（TE）信号は非常に重要です。 これにより、アプリケーションはディスプレイ･メモリの更新をディスプレイのリフレッシュ･レートと正確に同期することができます。 アプリケーションが、ディスプレイ上のティアリングを防止するのにも役立ちます。 ディスプレイは更新サイクルを開始すると、必ずこの信号をアサートします。 マイクロコントローラはこの信号を使用して、ディスプレイへのデータ転送を開始します。</p><p>TE信号は、マイクロコントローラの外部割込み入力に接続されています。 CubeMxは、このピン上に割込みを生成して設定します。</p><p>ドライバ内のコールバックが、TouchGFXに描画開始の信号を送ります。</p><div class="code-header"><div><h5>MB1642BDisplayDriver.c</h5></div></div><div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">void</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">HAL_GPIO_EXTI_Rising_Callback</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token keyword" style="font-style:italic">uint16_t</span><span class="token plain"> GPIO_Pin</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token function" style="color:rgb(130, 170, 255)">touchgfxSignalVSync</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="コードをクリップボードにコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="external-flash">外部Flash<a class="hash-link" href="#external-flash" title="見出しに直接リンク">​</a></h3><p>ディスプレイ･シールド上のSPI NOR Flashは、標準のSPI Flashです。 このドライバはディスプレイ･ドライバよりシンプルです。 Flashからデータを読み取るために、特別な初期化の必要はありません。</p><p>ドライバはポーリングされたSPI（全バイトでビジー･ウェイト）を使用してデータを読み取るか、DMAを使用することができます。 DMAでデータ受信の開始までの時間は、ポーリング･モードで20バイトを読み取るためにかかる時間とほぼ同じなので、短いデータの読み取りではポーリングより遅くなることがよくあります。 一方、DMAは割込み中（sysTickまたはアプリケーション割込みなど）でも実行を続け、マイクロコントローラがピクセルの描画でビジー状態にあるときでも、バックグラウンドで実行可能です。 こうした理由から両方の方法が使用されます。</p><p>Flashドライバはディスプレイ･ドライバとは別のDMAチャネルを使用するので、新しいデータの受信とすでに描画済みのピクセルの転送を同時に実行できます。</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="linker-script">リンカ･スクリプト<a class="hash-link" href="#linker-script" title="見出しに直接リンク">​</a></h4><p>リンカによって、アプリケーション内のさまざまなデータの配置場所をコントロールします。 これはリンカ･スクリプトで指定します。 gccコンパイラ用のリンカ･スクリプトの最初の部分を以下に示します。</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">MEMORY</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">{</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  RAM        (xrw)    : ORIGIN = 0x20000000,   LENGTH = 36K</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  FLASH      (rx)     : ORIGIN = 0x8000000,    LENGTH = 128K</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  SPI_FLASH  (r)      : ORIGIN = 0x90000000,   LENGTH = 8M</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="コードをクリップボードにコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>ここでは、NOR Flashのアドレスが0x90000000から始まると宣言しています。 ターゲット･アプリケーションのFlashドライバは、SPI Flashから0x90000000アドレスにあるデータを読み出します（下位24ビットをFlash内のアドレスとして使用）。</p><p>STM32CubeProgrammerで使用される外部Flashローダは、この範囲のデータをSPI Flashに書き込むことができます（下記を参照）。</p><p>この次のセクションでは、SPI Flashに画像（ExtFlashSection）データとフォント（FontFlashSection）データを配置しています。</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">  ExtFlashSection :</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    *(ExtFlashSection ExtFlashSection.*)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    *(.gnu.linkonce.r.*)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    . = ALIGN(0x4);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  } &gt;SPI_FLASH</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  FontFlashSection :</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    *(FontFlashSection FontFlashSection.*)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    *(.gnu.linkonce.r.*)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    . = ALIGN(0x4);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  } &gt;SPI_FLASH</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="コードをクリップボードにコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>リンカ･スクリプトに同様のセクションを追加することで、その他のデータもSPI Flashに配置することができます。</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="flash-loader">Flashローダ<a class="hash-link" href="#flash-loader" title="見出しに直接リンク">​</a></h4><p>G071 TouchGFXボード設定には、STM32CubeProgrammer用のFlashローダが含まれています。 Flashローダは、SPI NOR Flashにデータを書き込むことができます。</p><p>このFlashローダは、<code>gcc/S25FL032P_STM32G071B-NUCLEO.stldr</code>というファイルにあります。</p><p>STM32CubeIDEプロジェクトはCubeIDEから直接書き込めますが、IARまたはKeilアプリケーションはSTM32CubeProgrammerを使用して書き込む必要があります。</p><p>FlashローダはSTM32CubeProgrammerで最初から使用することはできず、インストール場所にstldrファイルをコピーすることでインストールする必要があります。</p><div class="figure"><a href="/4.21/ja/img/development/scenarios/touchgfx-on-lowcost-hardware/copying-stldr.webp" target="_blank"><img src="/4.21/ja/img/development/scenarios/touchgfx-on-lowcost-hardware/copying-stldr.webp"></a><p>STM32CubeProgrammerインストール場所へのFlashローダのコピー</p></div><p>これで通常どおりに、STM32CubeProgrammerでFlashローダを選択できるようになります。</p><div class="figure"><a href="/4.21/ja/img/development/scenarios/touchgfx-on-lowcost-hardware/select-stldr.webp" target="_blank"><img src="/4.21/ja/img/development/scenarios/touchgfx-on-lowcost-hardware/select-stldr.webp"></a><p>STM32CubeProgrammerインストール場所へのFlashローダのコピー</p></div><div class="highlight highlight-tip"><div class="highlight-heading"><h5><div class="highlight-icon"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></div>Tip</h5></div><div class="highlight-content">このFlashローダは、Nucleo-G071RBボードで使用される特定のGPIO設定でのみ動作します。<p>シリアルFlash用の別のGPIO設定がカスタム･ハードウェア上で使用されている場合は、Flashローダを同じように変更する必要があります。</p></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="buttons">ボタン<a class="hash-link" href="#buttons" title="見出しに直接リンク">​</a></h3><p>ボタン･ドライバは非常にシンプルです。 ここでは、MB1642B上でジョイスティック用に使用される5つのGPIOと、Nucleoボード上の青色のユーザ･ボタンの状態を取得します。</p><p>このボタン･ドライバは、TouchGFXでBottonControllerとしてインストールされています。 つまり、ボタンの押下はTouchGFX Designerのインタラクション内で直接利用可能だということです。 以下のように、ユーザ･コード内で使用することもできます。</p><div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">void</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(255, 203, 107)">Screen1View</span><span class="token double-colon punctuation" style="color:rgb(199, 146, 234)">::</span><span class="token function" style="color:rgb(130, 170, 255)">handleKeyEvent</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token keyword" style="font-style:italic">uint8_t</span><span class="token plain"> key</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">key </span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token plain"> </span><span class="token char" style="color:rgb(130, 170, 255)">&#x27;6&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token function" style="color:rgb(130, 170, 255)">application</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token function" style="color:rgb(130, 170, 255)">gotoScreen2Screen</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="コードをクリップボードにコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>使用されるキー･コードは以下のとおりです。</p><table><thead><tr><th><strong>キー</strong></th><th align="right"><strong>コード</strong></th></tr></thead><tbody><tr><td>左（Left）</td><td align="right">&#x27;4&#x27;</td></tr><tr><td>右（Right）</td><td align="right">&#x27;6&#x27;</td></tr><tr><td>上（Up）</td><td align="right">&#x27;8&#x27;</td></tr><tr><td>下（Down）</td><td align="right">&#x27;2&#x27;</td></tr><tr><td>中央（Center）</td><td align="right">&#x27;5&#x27;</td></tr><tr><td>青色のユーザ･ボタン（Blue User Button）</td><td align="right">&#x27;0&#x27;</td></tr></tbody></table><p>これらのキーは、キーボードのテンキーを使用してシミュレータを実行する（TouchGFX Designerで<code>F5</code>キーを押す）場合にも使用できます。</p></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="ドキュメント･ページのナビゲーション"><a class="pagination-nav__link pagination-nav__link--prev" href="/4.21/ja/docs/category/scenarios-2"><div class="pagination-nav__sublabel">前へ</div><div class="pagination-nav__label">Scenarios</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/4.21/ja/docs/development/scenarios/touchgfx-on-gpu2d"><div class="pagination-nav__sublabel">次へ</div><div class="pagination-nav__label">NeoChrom上のTouchGFX</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#hardware-overview" class="table-of-contents__link toc-highlight">ハードウェアの概要</a><ul><li><a href="#gpio-allocation" class="table-of-contents__link toc-highlight">GPIO割り当て</a></li><li><a href="#starting-a-project" class="table-of-contents__link toc-highlight">プロジェクトの開始</a></li></ul></li><li><a href="#display-updates" class="table-of-contents__link toc-highlight">ディスプレイの更新</a><ul><li><a href="#drawing-speed" class="table-of-contents__link toc-highlight">描画速度</a></li></ul></li><li><a href="#touchgfx-limitations-with-serial-flash" class="table-of-contents__link toc-highlight">シリアルFlash搭載のTouchGFXの制限事項</a><ul><li><a href="#texture-mapper" class="table-of-contents__link toc-highlight">テクスチャ･マッパー</a></li><li><a href="#bitmap-painter" class="table-of-contents__link toc-highlight">ビットマップ･ペインタ</a></li><li><a href="#l8-palette" class="table-of-contents__link toc-highlight">L8パレット</a></li></ul></li><li><a href="#drivers" class="table-of-contents__link toc-highlight">ドライバ</a><ul><li><a href="#display" class="table-of-contents__link toc-highlight">ディスプレイ</a></li><li><a href="#external-flash" class="table-of-contents__link toc-highlight">外部Flash</a></li><li><a href="#buttons" class="table-of-contents__link toc-highlight">ボタン</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">All rights reserved © 2022 STMicroelectronics | <a href="https://www.st.com/content/st_com/ja/common/terms-of-use.html">ご利用条件</a> | <a href="https://www.st.com/content/st_com/ja/common/privacy-policy.html">プライバシー･ポリシー</a> | <a href="/docs/miscellaneous/cookie-policy">Cookieポリシー</a> | <a href="https://app-de.onetrust.com/app/#/webform/2b87200d-4023-4588-9df7-ab0cdea1a67e">権利行使</a></div></div></div></footer></div></div>
<script src="/4.21/ja/assets/js/runtime~main.acc27096.js"></script>
<script src="/4.21/ja/assets/js/main.67dd044a.js"></script>
</body>
</html>