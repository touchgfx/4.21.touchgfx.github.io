"use strict";(self.webpackChunktouchgfx_documentation=self.webpackChunktouchgfx_documentation||[]).push([[4744],{3905:function(e,t,n){n.d(t,{Zo:function(){return c},kt:function(){return h}});var i=n(67294);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function r(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,i,o=function(e,t){if(null==e)return{};var n,i,o={},a=Object.keys(e);for(i=0;i<a.length;i++)n=a[i],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)n=a[i],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var s=i.createContext({}),u=function(e){var t=i.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):r(r({},t),e)),n},c=function(e){var t=u(e.components);return i.createElement(s.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return i.createElement(i.Fragment,{},t)}},p=i.forwardRef((function(e,t){var n=e.components,o=e.mdxType,a=e.originalType,s=e.parentName,c=l(e,["components","mdxType","originalType","parentName"]),p=u(n),h=o,m=p["".concat(s,".").concat(h)]||p[h]||d[h]||a;return n?i.createElement(m,r(r({ref:t},c),{},{components:n})):i.createElement(m,r({ref:t},c))}));function h(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var a=n.length,r=new Array(a);r[0]=p;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l.mdxType="string"==typeof e?e:o,r[1]=l;for(var u=2;u<a;u++)r[u]=n[u];return i.createElement.apply(null,r)}return i.createElement.apply(null,n)}p.displayName="MDXCreateElement"},70814:function(e,t,n){var i=n(67294),o=n(88678);const a=i.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},i.createElement("path",{fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"}));class r extends i.Component{render(){return i.createElement(o.Z,{color:"var(--highlight-color-caution)",header:"Caution",type:"caution",icon:a},this.props.children)}}t.Z=r},22425:function(e,t,n){var i=n(67294);class o extends i.Component{render(){return i.createElement("div",{className:"code-header"},i.createElement("div",null,i.createElement("h5",null,this.props.children)))}}t.Z=o},44035:function(e,t,n){var i=n(67294),o=n(25026);t.Z=function(e){const t=e.noShadow||!1,n=e.width,a=e.height,r=(0,o.Z)(e.imageSource);return t?i.createElement("div",{className:"figure noshadow"},i.createElement("a",{href:r,target:"_blank"},i.createElement("img",{width:n,height:a,src:r})),i.createElement("p",null,e.children)):i.createElement("div",{className:"figure"},i.createElement("a",{href:r,target:"_blank"},i.createElement("img",{width:n,height:a,src:r})),i.createElement("p",null,e.children))}},88678:function(e,t,n){var i=n(67294);class o extends i.Component{render(){const e=`highlight highlight-${this.props.type}`;return i.createElement("div",{className:e},i.createElement("div",{className:"highlight-heading"},i.createElement("h5",null,i.createElement("div",{className:"highlight-icon"},this.props.icon),this.props.header)),i.createElement("div",{className:"highlight-content"},this.props.children))}}t.Z=o},93054:function(e,t,n){var i=n(67294),o=n(88678);const a=i.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},i.createElement("path",{fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}));class r extends i.Component{render(){return i.createElement(o.Z,{color:"var(--highlight-color-note)",header:"Note",type:"note",icon:a},this.props.children)}}t.Z=r},10093:function(e,t,n){n.r(t),n.d(t,{assets:function(){return w},contentTitle:function(){return k},default:function(){return x},frontMatter:function(){return f},metadata:function(){return b},toc:function(){return v}});var i=n(3905),o=n(70814),a=n(22425),r=n(44035),l=n(93054),s=Object.defineProperty,u=Object.defineProperties,c=Object.getOwnPropertyDescriptors,d=Object.getOwnPropertySymbols,p=Object.prototype.hasOwnProperty,h=Object.prototype.propertyIsEnumerable,m=(e,t,n)=>t in e?s(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,g=(e,t)=>{for(var n in t||(t={}))p.call(t,n)&&m(e,n,t[n]);if(d)for(var n of d(t))h.call(t,n)&&m(e,n,t[n]);return e};const f={id:"known-issues",title:"Known Issues"},k=void 0,b={unversionedId:"miscellaneous/known-issues",id:"miscellaneous/known-issues",title:"Known Issues",description:"",source:"@site/docs/miscellaneous/known-issues.mdx",sourceDirName:"miscellaneous",slug:"/miscellaneous/known-issues",permalink:"/4.21/ko/docs/miscellaneous/known-issues",draft:!1,tags:[],version:"current",frontMatter:{id:"known-issues",title:"Known Issues"},sidebar:"docs",previous:{title:"Getting Help",permalink:"/4.21/ko/docs/miscellaneous/getting-help"},next:{title:"Changelog",permalink:"/4.21/ko/docs/miscellaneous/changelog"}},w={},v=[{value:"TouchGFX 4.21.0",id:"touchgfx-4-21-0",level:2},{value:"WideTextAction",id:"widetextaction",level:3},{value:"Compiling STM32U599 projects with IAR",id:"compiling-stm32u599-projects-with-iar",level:3},{value:"SVG drawing on STM32 with NeoChrom",id:"svg-drawing-on-stm32-with-neochrom",level:3},{value:"TouchGFX 4.20.0",id:"touchgfx-4-20-0",level:2},{value:"Painter interface changed",id:"painter-interface-changed",level:3},{value:"Painter implementation moved to generated files",id:"painter-implementation-moved-to-generated-files",level:3},{value:"Instructions",id:"instructions",level:4},{value:"Linker errors",id:"linker-errors",level:4},{value:"Debugging STM32G0 with Keil",id:"debugging-stm32g0-with-keil",level:3},{value:"Compiling STM32U5 and STM32L5 projects with Keil",id:"compiling-stm32u5-and-stm32l5-projects-with-keil",level:3},{value:"LOGONSERVER environment variable",id:"logonserver-environment-variable",level:3},{value:"TouchGFX 4.19.0",id:"touchgfx-4-19-0",level:2},{value:"STM32CubeMX code generation with MJPEG Video on H7",id:"stm32cubemx-code-generation-with-mjpeg-video-on-h7",level:3},{value:"New way of working with typographies",id:"new-way-of-working-with-typographies",level:3},{value:"Example: Auto generated font ids",id:"example-auto-generated-font-ids",level:4},{value:"Auto generated typographies when upgrading to 4.19.0",id:"auto-generated-typographies-when-upgrading-to-4190",level:4},{value:"Referencing font ids in user code",id:"referencing-font-ids-in-user-code",level:4},{value:"Using LibJPEG with ARMCLANG",id:"using-libjpeg-with-armclang",level:3},{value:"MJPEG Video on H750B Discovery",id:"mjpeg-video-on-h750b-discovery",level:3},{value:"ThreadX assembler files",id:"threadx-assembler-files",level:3},{value:"TouchGFX 4.18.0",id:"touchgfx-4-18-0",level:2},{value:"Issues with CubeMX 6.1.0 and CubeProgrammer 2.6",id:"issues-with-cubemx-610-and-cubeprogrammer-26",level:3},{value:"New .touchgfx format",id:"new-touchgfx-format",level:3},{value:"Default values are not written to .touchgfx",id:"default-values-are-not-written-to-touchgfx",level:4},{value:"Removed TextEntries block",id:"removed-textentries-block",level:4},{value:"LCD16bpp::fillRect and LCD16bpp::drawGlyph",id:"lcd16bpp-fillrect-and-lcd16bpp-drawglyph",level:3},{value:"Makefile and xlsx",id:"makefile-and-xlsx",level:3},{value:"Font size limit in texts.xsd",id:"font-size-limit-in-textsxsd",level:3},{value:"SDL2 linker error on Linux",id:"sdl2-linker-error-on-linux",level:3},{value:"TouchGFX 4.17.0",id:"touchgfx-4-17-0",level:2},{value:"Painters no longer support setAlpha()",id:"painters-no-longer-support-setalpha",level:3},{value:"Using the HAL class",id:"using-the-hal-class",level:3},{value:"FMC Display Interface in TouchGFX Generator",id:"fmc-display-interface-in-touchgfx-generator",level:3},{value:"L8 images in 16- 24- or 32bpp configurations",id:"l8-images-in-16-24-or-32bpp-configurations",level:3},{value:"TouchGFX 4.15.0",id:"touchgfx-4150",level:2},{value:"MCU support",id:"mcu-support",level:3},{value:"TouchGFX 4.14.0",id:"touchgfx-4140",level:2},{value:"ARMCLANG Support",id:"armclang-support",level:3},{value:"Workflow",id:"workflow",level:4},{value:"TouchGFX 4.13.0",id:"touchgfx-4130",level:2},{value:"Bugs",id:"bugs",level:3},{value:"Font Converter",id:"font-converter",level:4},{value:"Additional Compiler Support",id:"additional-compiler-support",level:3},{value:"Backwards Compatibility",id:"backwards-compatibility",level:3},{value:"Deprecated Features",id:"deprecated-features",level:4},{value:"TextureMapper is Disabled by Default",id:"texturemapper-is-disabled-by-default",level:4},{value:"HAL SDL1 incompatible",id:"hal-sdl1-incompatible",level:4},{value:"TouchGFX 4.12.3",id:"touchgfx-4123",level:2},{value:"Backwards compatibility",id:"backwards-compatibility-1",level:3},{value:"Screen transitions",id:"screen-transitions",level:4},{value:"Binary Fonts",id:"binary-fonts",level:4},{value:"TouchGFX 4.11.0",id:"touchgfx-4110",level:2},{value:"Backwards compatibility",id:"backwards-compatibility-2",level:3},{value:"TouchGFX 4.10.0",id:"touchgfx-4100",level:2},{value:"Upgrading from 4.9.x",id:"upgrading-from-49x",level:3},{value:"Backwards compatibility",id:"backwards-compatibility-3",level:3},{value:"Project Updater Issue",id:"project-updater-issue",level:3},{value:"TextArea and ChromART (DMA2D)",id:"textarea-and-chromart-dma2d",level:3},{value:"TouchGFX 4.9.0",id:"touchgfx-490",level:2},{value:"Upgrading from 4.8.0",id:"upgrading-from-480",level:3},{value:"Method 1: retain original file structure",id:"method-1-retain-original-file-structure",level:3},{value:"Method 2: import into new template",id:"method-2-import-into-new-template",level:3},{value:"Method 3: Manual upgrade without Designer",id:"method-3-manual-upgrade-without-designer",level:3}],y={toc:v};function x(e){var t,n=e,{components:s}=n,m=((e,t)=>{var n={};for(var i in e)p.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&d)for(var i of d(e))t.indexOf(i)<0&&h.call(e,i)&&(n[i]=e[i]);return n})(n,["components"]);return(0,i.kt)("wrapper",(t=g(g({},y),m),u(t,c({components:s,mdxType:"MDXLayout"}))),(0,i.kt)("p",null,"This article lists the issues that are known to be present in all TouchGFX versions, along with potential workarounds. Also, if there are any specific upgrade steps you need to perform to upgrade TouchGFX to a certain version, these will be mentioned. Note that if your current version is several releases old, you need to perform the upgrade steps for all the releases up to the new one."),(0,i.kt)("h2",g({},{id:"touchgfx-4-21-0"}),"TouchGFX 4.21.0"),(0,i.kt)("h3",g({},{id:"widetextaction"}),"WideTextAction"),(0,i.kt)("p",null,"The definition of the enumeration WideTextAction in Types.hpp has been\nchanged as it was misleading. If you are using WIDE_TEXT_WORDWRAP in\nTouchGFX 4.20 or earlier and expect to see an ellipsis (","\u2026","), you\nmust use WIDE_TEXT_WORDWRAP_ELLIPSIS in TouchGFX 4.21. See also ",(0,i.kt)("a",g({parentName:"p"},{href:"../development/ui-development/touchgfx-engine-features/texts-and-fonts#automatic-wrapping-of-long-text-lines"}),"Text and Fonts"),"."),(0,i.kt)("h3",g({},{id:"compiling-stm32u599-projects-with-iar"}),"Compiling STM32U599 projects with IAR"),(0,i.kt)("p",null,"When upgrading a TouchGFX project from version 4.20 or older project\nto TouchGFX 4.21 you will see a linking error in IAR."),(0,i.kt)("pre",null,(0,i.kt)("code",g({parentName:"pre"},{}),'Error[Li006]: duplicate definitions for "HAL_CPU2D_CommandListCpltCallback"; in "...\\Obj\\nema_hal.o", and "...\\Obj\\nema_hal_threadx.o"\nError[Li006]: duplicate definitions for "nema_buffer_create"; in "...\\Obj\\nema_hal.o", and "...\\Obj\\nema_hal_threadx.o"\n...\n')),(0,i.kt)("p",null,"The reason for this error is that the file\nTouchGFX/Target/generated/nema_hal_threadx.c has been renamed to\nTouchGFX/Target/generated/nema_hal.c. It was a bug to include the\noperating system in the filename. CubeMX creates a file with the new\nname while leaving the old file in place. Both files are compiled by\nIAR. The resolution is to remove the file\nTouchGFX/Target/generated/nema_hal_threadx.c."),(0,i.kt)("h3",g({},{id:"svg-drawing-on-stm32-with-neochrom"}),"SVG drawing on STM32 with NeoChrom"),(0,i.kt)("p",null,"SVG shapes with large coordinates may render incorrectly on targets\nwith NeoChrom. This is due to a limitation in the NeoChrom\nlibrary. The problem can arise either due to scaling up or due to\nlarge coordinates in the SVG itself."),(0,i.kt)("p",null,"The resolution is to insert a call to\n",(0,i.kt)("em",{parentName:"p"},"nema_vg_handle_large_coords()"),". A good place is in the function\n",(0,i.kt)("em",{parentName:"p"},"touchgfx_components_init()")," in\n",(0,i.kt)("inlineCode",{parentName:"p"},"TouchGFX/target/generated/TouchGFXConfiguration.cpp"),":"),(0,i.kt)("pre",null,(0,i.kt)("code",g({parentName:"pre"},{className:"language-cpp",metastring:"{5-5}","{5-5}":!0}),"void touchgfx_components_init()\n{\n    nema_init();\n    nema_vg_init(480, 480);\n    nema_vg_handle_large_coords(1, 1);\n}\n")),(0,i.kt)("p",null,"Note: This solution comes with a slight performance decrease."),(0,i.kt)("h2",g({},{id:"touchgfx-4-20-0"}),"TouchGFX 4.20.0"),(0,i.kt)("h3",g({},{id:"painter-interface-changed"}),"Painter interface changed"),(0,i.kt)("p",null,"The method AbstractPainter::render() has been replaced by\n",(0,i.kt)("a",g({parentName:"p"},{href:"../api/classes/classtouchgfx_1_1_abstract_painter#function-paint"}),"AbstractPainter::paint")," for performance reasons.",(0,i.kt)("br",{parentName:"p"}),"\n","If you have implemented your own painter classes you need to adapt to\nthis new interface. Read more in the ",(0,i.kt)("a",g({parentName:"p"},{href:"../development/ui-development/touchgfx-engine-features/canvas-widgets"}),"article")," on Canvas Widgets."),(0,i.kt)("h3",g({},{id:"painter-implementation-moved-to-generated-files"}),"Painter implementation moved to generated files"),(0,i.kt)("p",null,"In TouchGFX 4.20 the software routines that paint circles, lines, and\nother shapes have been moved from the framework code to the code\ngenerated by CubeMX. This means that you have to regenerate code in\nCubeMX after upgrading a project from TouchGFX 4.19.1 (or earlier) to\nTouchGFX 4.20. The reason for this change is to be able to use the\ngraphics accelerator, DMA2D, when drawing circles and lines."),(0,i.kt)("h4",g({},{id:"instructions"}),"Instructions"),(0,i.kt)("p",null,"Find and open the .ioc file in the project root folder:"),(0,i.kt)(r.Z,{imageSource:"/img/miscellaneous/known-issues/project-root-ioc.png",mdxType:"Figure"},"Project IOC file"),(0,i.kt)("p",null,"Select TouchGFX 4.20 in the Software Packs Component Selector (alt-O):"),(0,i.kt)(r.Z,{imageSource:"/img/miscellaneous/known-issues/xcube-tgfx-420-selected.png",mdxType:"Figure"},"Selecting TouchGFX 4.20"),(0,i.kt)("p",null,'Close this dialog and press "Generate Code" in upper right corner. Now\ngo to the TouchGFX Designer and regenerate code (F4).'),(0,i.kt)("h4",g({},{id:"linker-errors"}),"Linker errors"),(0,i.kt)("p",null,"If you don't regenerate the code you will get linker errors if your\nproject uses e.g. the Circle widget. The errors looks like this (here for 16bpp):"),(0,i.kt)("pre",null,(0,i.kt)("code",g({parentName:"pre"},{}),"Linking TouchGFX/build/bin/target.elf\nMiddlewares/ST/touchgfx/lib/core/cortex_m7/gcc\\libtouchgfx.a(PainterRGB565.o): In function `touchgfx::PainterRGB565::paint(unsigned char*, short, short, short, short, unsigned char) const':\n(.text._ZNK8touchgfx13PainterRGB5655paintEPhssssh+0x1a): undefined reference to `touchgfx::paint::rgb565::lineFromColor(unsigned short*, unsigned int, unsigned long, unsigned char, unsigned long)'\nMiddlewares/ST/touchgfx/lib/core/cortex_m7/gcc\\libtouchgfx.a(PainterRGB565.o): In function `touchgfx::PainterRGB565::tearDown() const':\n(.text._ZNK8touchgfx13PainterRGB5658tearDownEv+0x0): undefined reference to `touchgfx::paint::rgb565::tearDown()'\ncollect2.exe: error: ld returned 1 exit status\n")),(0,i.kt)("p",null,"For 24bpp:"),(0,i.kt)("pre",null,(0,i.kt)("code",g({parentName:"pre"},{}),"Linking TouchGFX/build/bin/target.elf\n        Middlewares/ST/touchgfx/lib/core/cortex_m7/gcc\\libtouchgfx.a(PainterRGB888.o): In function `touchgfx::PainterRGB888::paint(unsigned char*, short, short, short, short, unsigned char) const':\n        (.text._ZNK8touchgfx13PainterRGB8885paintEPhssssh+0x18): undefined reference to `touchgfx::paint::rgb888::lineFromColor(unsigned char*, unsigned int, unsigned long, unsigned char)'\n        Middlewares/ST/touchgfx/lib/core/cortex_m7/gcc\\libtouchgfx.a(PainterRGB888.o): In function `touchgfx::PainterRGB888::tearDown() const':\n        (.text._ZNK8touchgfx13PainterRGB8888tearDownEv+0x0): undefined reference to `touchgfx::paint::rgb888::tearDown()'\n        collect2.exe: error: ld returned 1 exit status\n")),(0,i.kt)("p",null,"The missing functions are generated into\n",(0,i.kt)("inlineCode",{parentName:"p"},"TouchGFX/target/generated/STM32DMA.cpp"),", when you regenerate code in CubeMX."),(0,i.kt)("p",null,"If your controller does not have DMA2D (or it is not enabled), CubeMX\nwill include the software routines that was used in TouchGFX 4.19.1\nand previous versions."),(0,i.kt)("p",null,"If you for some reason cannot regenerate code in CubeMX, you can\nmanually add the missing functions by inserting the following includes\nin a .cpp file in your application:"),(0,i.kt)("pre",null,(0,i.kt)("code",g({parentName:"pre"},{}),"#include <touchgfx/hal/Paint.hpp>\n#include <touchgfx/hal/PaintRGB565Impl.hpp> // 16bpp painting routines\n#include <touchgfx/hal/PaintRGB888Impl.hpp> // 24bpp painting routines\n")),(0,i.kt)("h3",g({},{id:"debugging-stm32g0-with-keil"}),"Debugging STM32G0 with Keil"),(0,i.kt)("p",null,'TouchGFX projects for STM32G0 boards with the X-NUCLEO-GFX01M1/2\ndisplay modules uses the address range from 0x90000000 for data in the\nexternal SPI flash. This breaks the Keil debugger as it tries to\naccess these addresses when starting a debug session. Keil gives the\nerror "Cannot access target. Shutting down debug session."'),(0,i.kt)(r.Z,{imageSource:"/img/miscellaneous/known-issues/stm32g0-debugging-keil.png",mdxType:"Figure"},"Starting a debug session in Keil"),(0,i.kt)("p",null,"The solution is to create a init script for the debugger, with the text:"),(0,i.kt)("pre",null,(0,i.kt)("code",g({parentName:"pre"},{}),"load STM32G071_NUCLEO\\STM32G071_NUCLEO.axf NOCODE\ng,main\n")),(0,i.kt)("p",null,"The NOCODE option tells Keil to not load the code. This removes the access problem."),(0,i.kt)(r.Z,{imageSource:"/img/miscellaneous/known-issues/debug-ini.png",mdxType:"Figure"},"Debug initialization script for Keil"),(0,i.kt)("p",null,"And select the file in the debug configuration dialogue:"),(0,i.kt)(r.Z,{imageSource:"/img/miscellaneous/known-issues/keil-debug-dialog.png",mdxType:"Figure"},"Debug configuration for Keil"),(0,i.kt)("h3",g({},{id:"compiling-stm32u5-and-stm32l5-projects-with-keil"}),"Compiling STM32U5 and STM32L5 projects with Keil"),(0,i.kt)("p",null,"Keil projects created with CubeMx are missing the DSP extension tag in\nthe project file. This gives linker error when linking with the\nTouchGFX library, which has the DSP extension tag set. The linker\nerrors will be like:"),(0,i.kt)("pre",null,(0,i.kt)("code",g({parentName:"pre"},{}),"STM32U575ZI_NUCLEO\\STM32U575ZI_NUCLEO.axf: Error: L6366E: abstractpartition.o attributes are not compatible with the provided attributes.\nObject abstractpartition.o contains Build Attributes that are incompatible with the provided attributes.\nTag_DSP_extension = This code was permitted to use Thumb DSP functions as an optional architecture extension above the base architecture as indicated by Tag_CPU_arch (=1)\n")),(0,i.kt)("p",null,"The solution is to add the DSP tag in your .uvprojx project file (in the /Project/Targets/Target/TargetOption/TargetCommonOption/Cpu XML-element):"),(0,i.kt)("pre",null,(0,i.kt)("code",g({parentName:"pre"},{className:"language-cpp",metastring:"{14-14}","{14-14}":!0}),'<Targets>\n    <Target>\n      <TargetName>STM32U575ZI_NUCLEO</TargetName>\n      <ToolsetNumber>0x4</ToolsetNumber>\n      <ToolsetName>ARM-ADS</ToolsetName>\n      <pCCUsed>6120000::V6.12::.\\ARMCLANG</pCCUsed>\n      <uAC6>1</uAC6>\n      <TargetOption>\n        <TargetCommonOption>\n          <Device>STM32U575ZITx</Device>\n          <Vendor>STMicroelectronics</Vendor>\n          <PackID>Keil.STM32U5xx_DFP.2.0.0</PackID>\n          <PackURL>https://www.keil.com/pack/</PackURL>\n          <Cpu>IRAM(0x20000000-0x200BFFFF) IROM(0x08000000-0x81FFFFF) CLOCK(8000000) FPU3(SFPU) CPUTYPE("Cortex-M33") ELITTLE TZ DSP</Cpu>\n          <FlashUtilSpec></FlashUtilSpec>\n')),(0,i.kt)("h3",g({},{id:"logonserver-environment-variable"}),"LOGONSERVER environment variable"),(0,i.kt)("p",null,'We have observed on a few computers that the TouchGFX is very slow\n(e.g. "Run simulator" does nothing for 30 seconds). It may help to set\nthe environment variable LOGONSERVER to an empty value.'),(0,i.kt)("p",null,"In bash, the command is:"),(0,i.kt)("pre",null,(0,i.kt)("code",g({parentName:"pre"},{}),"export LOGONSERVER=\n")),(0,i.kt)("h2",g({},{id:"touchgfx-4-19-0"}),"TouchGFX 4.19.0"),(0,i.kt)("h3",g({},{id:"stm32cubemx-code-generation-with-mjpeg-video-on-h7"}),"STM32CubeMX code generation with MJPEG Video on H7"),(0,i.kt)("p",null,"When generating code with MJPEG Video on e.g. an STM32H750 with STM32CubeMX 6.3.0 or earlier, unfortunately, the code to configure the MDMA to the MDMA handlers, as shown in ",(0,i.kt)("a",g({parentName:"p"},{href:"../development/touchgfx-hal-development/scenarios/scenarios-video-decoding#stm32h750-dk"}),"Video Decoding"),", is missing and developers must add the highlighted user code manually:"),(0,i.kt)(a.Z,{mdxType:"CodeHeader"},"Core\\Src\\stm32h7xx_hal_msp.c"),(0,i.kt)("pre",null,(0,i.kt)("code",g({parentName:"pre"},{className:"language-cpp",metastring:"{6-7}","{6-7}":!0}),"void HAL_JPEG_MspInit(JPEG_HandleTypeDef* hjpeg)\n{\n  if(hjpeg->Instance==JPEG)\n  {\n  /* USER CODE BEGIN JPEG_MspInit 0 */\n     hmdma_jpeg_infifo_th.Init.Request = MDMA_REQUEST_JPEG_INFIFO_TH;\n     hmdma_jpeg_outfifo_th.Init.Request = MDMA_REQUEST_JPEG_OUTFIFO_TH;\n  /* USER CODE END JPEG_MspInit 0 */\n   ...\n\n")),(0,i.kt)("h3",g({},{id:"new-way-of-working-with-typographies"}),"New way of working with typographies"),(0,i.kt)("p",null,"From TouchGFX 4.18.1 to TouchGFX 4.19.0 the use of typographies has\nchanged. A typography now has a default setting and zero or more\nlanguage specific settings."),(0,i.kt)("p",null,"Read more about this in the ",(0,i.kt)("a",g({parentName:"p"},{href:"/4.21/ko/docs/development/ui-development/designer-user-guide/texts-view"}),"Designer Guide")),(0,i.kt)("p",null,"Text specific direction and typography is\nno longer an option, these options are moved to the new default and\nlanguage specific settings. This new functionality affects the\ngenerated code in projects that used this feature. The Text Converter\nwill generate a font id for the default setting and one for each\nlanguage specific setting. A font id generated from a language\nspecific setting will be named automatically, see example below."),(0,i.kt)(r.Z,{imageSource:"/img/miscellaneous/known-issues/text-specific-direction.png",mdxType:"Figure"},"Setting direction and typography for a specific text in TouchGFX 4.18"),(0,i.kt)("h4",g({},{id:"example-auto-generated-font-ids"}),"Example: Auto generated font ids"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Default typography id: HEADLINE"),(0,i.kt)("li",{parentName:"ul"},"Language specific setting: JPN")),(0,i.kt)("p",null,"This will generate two font ids in ",(0,i.kt)("inlineCode",{parentName:"p"},"generated/fonts/include/fonts/ApplicationFontProvider.hpp"),":"),(0,i.kt)("pre",null,(0,i.kt)("code",g({parentName:"pre"},{className:"language-cpp"}),"struct TypographyFontIndex\n{\n    static const touchgfx::FontId HEADLINE = 0;\n    static const touchgfx::FontId HEADLINE_AUTO_GENERATED_FOR_JPN = 1;\n};\n")),(0,i.kt)("h4",g({},{id:"auto-generated-typographies-when-upgrading-to-4190"}),"Auto generated typographies when upgrading to 4.19.0"),(0,i.kt)("p",null,"As mentioned, the text specific direction and typography is no longer an\noption. As a result of this change in functionality, new typographies with\ndefault and language specific settings might be generated, when upgrading\nolder versions. You can identify these auto generated typographies by\ntheir id. Either the text direction is used as suffix or a letter in the\nrange A-Z:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Headline_LTR"),(0,i.kt)("li",{parentName:"ul"},"PosterText_RTL"),(0,i.kt)("li",{parentName:"ul"},"Title_A"),(0,i.kt)("li",{parentName:"ul"},"ButtonText_B")),(0,i.kt)("h4",g({},{id:"referencing-font-ids-in-user-code"}),"Referencing font ids in user code"),(0,i.kt)("p",null,"If you are referencing font ids in the user code, these might need to\nbe updated. In cases where font ids are not referenced by symbol but\nby value, there is a risk of errors, as the font ids can change during\nan upgrade. It is recommended to always reference font ids by symbol,\ni.e. use ",(0,i.kt)("inlineCode",{parentName:"p"},"TypographyFontIndex::HEADLINE")," instead of ",(0,i.kt)("inlineCode",{parentName:"p"},"0"),"."),(0,i.kt)("h3",g({},{id:"using-libjpeg-with-armclang"}),"Using LibJPEG with ARMCLANG"),(0,i.kt)("p",null,"ARMCLANG projects where the LibJPEG middlewares is selected in CubeMX\ncannot run. ARMCLANG enables semi-hosting because LibJPEG refers to\nthe libc file functions (e.g. fopen).",(0,i.kt)("br",{parentName:"p"}),"\n","Semi-hosting makes the application wait for a\nconnection to a semi-hosting-aware debugger during startup.",(0,i.kt)("br",{parentName:"p"}),"\n","One way to resolve this issue is to remove references to fopen in\nLibJPEG by undefining JFILE in two files: ",(0,i.kt)("inlineCode",{parentName:"p"},"LibJPEG/source/jdatasrc.c"),"\nand ",(0,i.kt)("inlineCode",{parentName:"p"},"LibJPEG/source/jdatadst.c"),":"),(0,i.kt)(a.Z,{mdxType:"CodeHeader"},"LibJPEG/source/jdatasrc.c"),(0,i.kt)("pre",null,(0,i.kt)("code",g({parentName:"pre"},{className:"language-cpp",metastring:"{3-3}","{3-3}":!0}),'#include "jerror.h"\n\n#undef JFILE\n\n/* Expanded data source object for stdio input */\n#ifdef JFILE \n')),(0,i.kt)(a.Z,{mdxType:"CodeHeader"},"LibJPEG/source/jdatadst.c"),(0,i.kt)("pre",null,(0,i.kt)("code",g({parentName:"pre"},{className:"language-cpp",metastring:"{3-3}","{3-3}":!0}),'#include "jerror.h"\n\n#undef JFILE\n\n#ifndef HAVE_STDLIB_H       /* <stdlib.h> should declare malloc(),free() */\n')),(0,i.kt)("h3",g({},{id:"mjpeg-video-on-h750b-discovery"}),"MJPEG Video on H750B Discovery"),(0,i.kt)("p",null,"The H750B Discovery board uses hardware decoding of YCbCr video\ndata. A bug in the code supplied with TouchGFX for this board causes\nvisible artifacts for some videos.",(0,i.kt)("br",{parentName:"p"}),"\n","A solution is to change to software decoding. In some cases it is also\npossible to remove the problem by changing the width of the video a\nfew pixels."),(0,i.kt)("h3",g({},{id:"threadx-assembler-files"}),"ThreadX assembler files"),(0,i.kt)("p",null,"The ThreadX assembler files for Keil IDE is using the new ARMCLANG V6\nassembler syntax. The startup.s files supplied in some firmware packs\nis using the syntax of the older ARMCC assembler.  This means that you\nhave to generally set your project to use the ARMCLANG V6 assembler,\nand then override this for the startup_stm32xxx.s:"),(0,i.kt)(r.Z,{imageSource:"/img/miscellaneous/known-issues/keil-assembler.png",mdxType:"Figure"},"Deselecting ARMCLANG V6 assembler for startup.s"),(0,i.kt)("h2",g({},{id:"touchgfx-4-18-0"}),"TouchGFX 4.18.0"),(0,i.kt)("h3",g({},{id:"issues-with-cubemx-610-and-cubeprogrammer-26"}),"Issues with CubeMX 6.1.0 and CubeProgrammer 2.6"),(0,i.kt)("p",null,'As of version CubeMX 6.1.0 EWARM projects generated by CubeMX do not work with X-CUBE-TOUCHGFX because of a wrong setting for "C/C++ Compiler" / "Language" option which was changed from "Auto" to "C++" causing compilation errors. This issue will be fixed in CubeMX 6.1.1. In the mean time, changing the option back  to "Auto", manually, will solve compilation issues but will be reverted upon code generation from CubeMX.'),(0,i.kt)("p",null,"A bug in CubeProgrammer 2.6 related to how external loaders (",(0,i.kt)("inlineCode",{parentName:"p"},".stldr"),') are referenced breaks Makefiles for all existing Application Templates (AT) and also prevents the "Run Target" feature in TouchGFX Designer from functioning correctly. This issue also extends to user projects based on current versions of the ATs. Application templates will receive an update to compensate for this bug and will work for both CubeProgrammer 2.5 and 2.6. If you\'ve got a project based on an AT that does not work with CubeProgrammer 2.6, you can make the following modifications to add support. Users must execute ',(0,i.kt)("inlineCode",{parentName:"p"},"STM32CubeProgrammer_CLI.exe")," from within the ",(0,i.kt)("inlineCode",{parentName:"p"},"bin")," folder when making a reference to an external loader. Generally, speaking:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"cd")," into the ",(0,i.kt)("inlineCode",{parentName:"li"},"bin")," folder of the STM32CubeProgrammer installation folder."),(0,i.kt)("li",{parentName:"ul"},"Execute the command to program the connected target with a ",(0,i.kt)("em",{parentName:"li"},"relative")," reference to the ",(0,i.kt)("inlineCode",{parentName:"li"},".stldr")," file.")),(0,i.kt)("pre",null,(0,i.kt)("code",g({parentName:"pre"},{}),'@cd "$(st_stm32cube_programmer_bin_path)" && ./$(stm_stm32cube_programmer_exe) -c port=SWD -d $(application_path)/$(binary_output_path)/target.hex -el $(stm32cubeLoader_relative_path) -hardRst\n')),(0,i.kt)(l.Z,{mdxType:"Note"},"The CubeProgrammer bug is solved in version 2.10."),(0,i.kt)("h3",g({},{id:"new-touchgfx-format"}),"New .touchgfx format"),(0,i.kt)("p",null,"From TouchGFX 4.17.0 to TouchGFX 4.18.0 the content of the .touchfgx\nfile has been changed significantly in two major areas. This may\nresult in a vastly updated .touchfgx file, simply by opening and\nsaving a .touchgfx project file using the TouchGFX Designer. The main\nchanges are in the following areas:"),(0,i.kt)("h4",g({},{id:"default-values-are-not-written-to-touchgfx"}),"Default values are not written to .touchgfx"),(0,i.kt)("p",null,"Widget parameters that have a default value e.g. as a box offset of\nX=0, Y=0 or the color black (red=0, green=0, blue=0) were previously\nwritten to the .touchgfx file, but in TouchGFX version 4.18.0 these\nvalues are not written. This may result in slightly smaller .touchgfx\nfiles."),(0,i.kt)("h4",g({},{id:"removed-textentries-block"}),"Removed TextEntries block"),(0,i.kt)("p",null,"SingleUseId's have been renamed to contain random numbers and letters\ninstead of sequential numbers to ease merging of a project with\nseveral active developers, as new single use text id's do not get the\nsame id. Also, the \"TextEntries\" section in the .touchgfx has been\nremoved, which may result in a vastly reduced .touchgfx file size."),(0,i.kt)("h3",g({},{id:"lcd16bpp-fillrect-and-lcd16bpp-drawglyph"}),"LCD16bpp::fillRect and LCD16bpp::drawGlyph"),(0,i.kt)("p",null,"The fillRect and drawGlyph functions in LCD16bpp now pass the full\n24bit color to the DMA, instead of the reduced 16bit (RGB565) color.\nThis may result in wrong colors on the hardware (not the simulator)\nand can be fixed by regenerating the DMA classes from CubeMX."),(0,i.kt)("h3",g({},{id:"makefile-and-xlsx"}),"Makefile and xlsx"),(0,i.kt)("p",null,'TouchGFX 4.18.0 uses a new .xml format for storing texts and\ntranslations instead of the old .xlsx format previously used. This\nmeans that all references of "texts.xlsx" in Makefiles and visual\nstudio projects should be changed to "texts.xml". The TextConvert tool\nwill recognise this, even if the old texts.xlsx file exist and the\ntexts.xml does not, and convert texts.xlsx to texts.xml for all future\nuses.'),(0,i.kt)("p",null,"To see a new, working Makefile, simply create a new (blank) project\nusing TouchGFX Designer and consult the generated Makefile located in\nfolder generated/simulator/gcc/Makefile."),(0,i.kt)("h3",g({},{id:"font-size-limit-in-textsxsd"}),"Font size limit in texts.xsd"),(0,i.kt)("p",null,"The texts.xsd which is used by the designer to validate the texts.xml\nhas a limit on the font size of 255. If you have font sizes greater than\n255, you will see an error message in the designer like this:"),(0,i.kt)(r.Z,{imageSource:"/img/miscellaneous/known-issues/font-size-limit-xsd.png",mdxType:"Figure"},"Error message - Font size limit"),(0,i.kt)("p",null,"The workaround is to close the project, change the Typographies Size\nattribute from xs:unsignedByte to xs:unsignedInt in the texts.xsd and\nreopen the project."),(0,i.kt)("h3",g({},{id:"sdl2-linker-error-on-linux"}),"SDL2 linker error on Linux"),(0,i.kt)("p",null,"The SDL2 libraries used by the simulator are now only included for\nWindows users. Linux users must install the SDL2 libraries themselves.\nThis is a task that has to be carried out only once, and for ubuntu\nthe command is"),(0,i.kt)("pre",null,(0,i.kt)("code",g({parentName:"pre"},{}),"sudo apt install libsdl2-dev libsdl2-image-dev\n")),(0,i.kt)("p",null,"to install libsdl2 and libsdl2-image including header files for\ndevelopment"),(0,i.kt)("h2",g({},{id:"touchgfx-4-17-0"}),"TouchGFX 4.17.0"),(0,i.kt)("h3",g({},{id:"painters-no-longer-support-setalpha"}),"Painters no longer support setAlpha()"),(0,i.kt)("p",null,"For performance reasons, Painters used by the Canvas Widget Renderer (CWR) no longer support alpha. The effect can still be achieved by setting the alpha on the Canvas Widget that has the Painter. In general code can be changed from looking something like this:"),(0,i.kt)("pre",null,(0,i.kt)("code",g({parentName:"pre"},{className:"language-cpp"}),"painter.setColor(Color::getColorFromRGB(0xFF, 0x00, 0x00));\npainter.setAlpha(128);\ncircle.setPainter(painter);\n")),(0,i.kt)("p",null,"to something like this:"),(0,i.kt)("pre",null,(0,i.kt)("code",g({parentName:"pre"},{className:"language-cpp"}),"painter.setColor(Color::getColorFromRGB(0xFF, 0x00, 0x00));\ncircle.setPainter(painter);\ncircle.setAlpha(128);\n")),(0,i.kt)("p",null,"If alpha was previously applied to both the Painter and the Canvas Widget, these two alpha values can be multiplied and then divided by 255, as follows:"),(0,i.kt)("pre",null,(0,i.kt)("code",g({parentName:"pre"},{className:"language-cpp"}),"painter.setColor(Color::getColorFromRGB(0xFF, 0x00, 0x00));\npainter.setAlpha(painterAlpha);\ncircle.setPainter(painter);\ncircle.setAlpha(circleAlpha);\n")),(0,i.kt)("p",null," becomes"),(0,i.kt)("pre",null,(0,i.kt)("code",g({parentName:"pre"},{className:"language-cpp"}),"painter.setColor(Color::getColorFromRGB(0xFF, 0x00, 0x00));\ncircle.setPainter(painter);\ncircle.setAlpha((painterAlpha * circleAlpha) / 255);\n")),(0,i.kt)("p",null,"or use LCD::div255() instead of dividing with 255."),(0,i.kt)("h3",g({},{id:"using-the-hal-class"}),"Using the HAL class"),(0,i.kt)("p",null,"Prior to version 4.17.0, the header file touchgfx/hal/HAL.hpp would be included by several files in the TouchGFX framework that did not use HAL at all. These unnecessary references have been cleaned up, and this may result in user code that will not compile because HAL is not known to the compiler. To fix this, simply include the HAL header file as follows:"),(0,i.kt)("pre",null,(0,i.kt)("code",g({parentName:"pre"},{className:"language-cpp"}),"#include <touchgfx/hal/HAL.hpp>\n")),(0,i.kt)("p",null,"Alternatively, the Screen class has two new functions getScreenWidth() and getScreenHeight() to give the screen size. This the recommended way to get the size of the screen and can be called directly from any subclass of Screen, such as e.g. Screen1View.cpp."),(0,i.kt)("h3",g({},{id:"fmc-display-interface-in-touchgfx-generator"}),"FMC Display Interface in TouchGFX Generator"),(0,i.kt)("p",null,"When using the new FMC Display Interface in TouchGFX Generator the ",(0,i.kt)("em",{parentName:"p"},"memory offset")," for FMC banks will not be correct (zero) when generating with CubeMX 6.2.1. This will be corrected in CubeMX 6.3.0 and upon release the minimum required version for X-CUBE-TouchGFX will be bumped to 6.3.0 rather than the current 6.2.1. Until then, users can enter the correct FMC BANK Memory addresses inside ",(0,i.kt)("inlineCode",{parentName:"p"},"TouchGFXGeneratedHAL.cpp")," (will be overwritten upon re-generation). E.g."),(0,i.kt)("pre",null,(0,i.kt)("code",g({parentName:"pre"},{className:"language-cpp"}),"#define FMC_BANK1_REG ((uint16_t *) 0x60000000)\n#define FMC_BANK1_MEM ((uint16_t *) 0x60000002)\n")),(0,i.kt)("p",null,"Users may also redefine them in ",(0,i.kt)("inlineCode",{parentName:"p"},"TouchGFXHAL.cpp")," entirely."),(0,i.kt)("h3",g({},{id:"l8-images-in-16-24-or-32bpp-configurations"}),"L8 images in 16- 24- or 32bpp configurations"),(0,i.kt)("p",null,"A call to ",(0,i.kt)("inlineCode",{parentName:"p"},"OSWrappers::taskYield()")," was mistakenly introduced to STM32DMA classes when loading CLUT for L8 images. To fix this, users can do the following:"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},"Navigate to your ",(0,i.kt)("inlineCode",{parentName:"li"},"Users/<user name>/STM32Cube/Repository/Packs/STMicroelectronics/X-CUBE-TOUCHGFX/4.17.0/CubeMX/templates/Target")," folder."),(0,i.kt)("li",{parentName:"ol"},"Open the appropriate ",(0,i.kt)("inlineCode",{parentName:"li"},"dma_Xbpp_implementation_tmp.ftl")," file based on your bit depth"),(0,i.kt)("li",{parentName:"ol"},"Delete or comment the call to ",(0,i.kt)("inlineCode",{parentName:"li"},"OSWrappers::taskYield()")," call in the ",(0,i.kt)("inlineCode",{parentName:"li"},"while ((READ_REG(DMA2D->FGPFCCR) & DMA2D_FGPFCCR_START) != 0U)")," loop, and regenerate code from STM32CubeMX to generate code using this modified template.")),(0,i.kt)("pre",null,(0,i.kt)("code",g({parentName:"pre"},{className:"language-cpp"}),"while ((READ_REG(DMA2D->FGPFCCR) & DMA2D_FGPFCCR_START) != 0U)\n{\n    // OSWrappers::taskYield();\n}\n")),(0,i.kt)("h2",g({},{id:"touchgfx-4150"}),"TouchGFX 4.15.0"),(0,i.kt)("h3",g({},{id:"mcu-support"}),"MCU support"),(0,i.kt)("p",null,'While Cortex-M33 is fully supported by TouchGFX, "Software Packs" (TouchGFX Generator, among others) cannot be enabled in the current verison of CubeMX (v6.0.1) for multi-context MCUs until support is added in CubeMX. Disabling "Trust Zone" for Cortex-M33 based MCUs, thus limiting the MCU to a single context, will allow you to enable TouchGFX Generator. TrustZone should be enabled manually in User Code sections.'),(0,i.kt)("h2",g({},{id:"touchgfx-4140"}),"TouchGFX 4.14.0"),(0,i.kt)("h3",g({},{id:"armclang-support"}),"ARMCLANG Support"),(0,i.kt)("p",null,"While TouchGFX now provides an ARMCLANG (ARM compiler v6.x) library for ",(0,i.kt)("em",{parentName:"p"},"Cortex-M0"),", ",(0,i.kt)("em",{parentName:"p"},"Cortex-M4f"),", ",(0,i.kt)("em",{parentName:"p"},"Cortex-M7")," and ",(0,i.kt)("em",{parentName:"p"},"Cortex-M33"),", CubeMX is not able to generate projects that enable the ARMCLANG compiler (ARM Compiler v6.x). This requires users who wish to use the compiler in their projects to select the compiler manually from the project options in Keil uVision."),(0,i.kt)("p",null,"If configuring the FreeRTOS middleware from within CubeMX, any generated project using ARMCC (ARM compiler  v5.x) will have FreeRTOS ",(0,i.kt)("em",{parentName:"p"},"portable"),' files that are not compatible with ARMCLANG; And these have to be replaced manually. Whenever "Generate code" is run from within CubeMX any manual changes will be overwritten and it would be wise to keep the project under version control (git, etc.) to undo these particular changes.'),(0,i.kt)("p",null,"In summary. Since CubeMX can only generate ARM Compiler v5.x compiler projects, users have to modify the following every time code is generated from CubeMX unless they keep their project under version control."),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},"Select ARM Compiler v6.x in project options."),(0,i.kt)("li",{parentName:"ol"},"Link with the ARMCLANG library instead of the ARMCC library (configured by CubeMX)."),(0,i.kt)("li",{parentName:"ol"},"If configuring FreeRTOS from within CubeMX, then the FreeRTOS portable files should be taken from the  ",(0,i.kt)("inlineCode",{parentName:"li"},"portable/GCC")," folder rather than ",(0,i.kt)("inlineCode",{parentName:"li"},"portable/RVDS")," (default for ARM Compiler v5.x) in order to be compatible with ARM Compiler v6.x.")),(0,i.kt)("h4",g({},{id:"workflow"}),"Workflow"),(0,i.kt)("p",null,"The following workflow describes how to use v6.x ARM Compiler from Keil uVision with CubeMX generated projects and a TouchGFX ARMCLANG library."),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},"Select ARMCLANG (v. 6.x) in Keil uVision.")),(0,i.kt)(r.Z,{imageSource:"/img/miscellaneous/known-issues/armclang-support.png",noShadow:!0,width:"650",mdxType:"Figure"},"ARMCLANG Support"),(0,i.kt)("ol",g({},{start:2}),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"If you're configuring FreeRTOS from CubeMX, CubeMX will generate the wrong portable files and configure your project to use those. You have to manually replace these with the ones (from ",(0,i.kt)("a",g({parentName:"p"},{href:"https://github.com/FreeRTOS/FreeRTOS-Kernel/tree/6199b72fbf57a7c5b3d7b195a3bd1446779314cd/portable/GCC"}),"https://github.com/FreeRTOS/FreeRTOS-Kernel/tree/6199b72fbf57a7c5b3d7b195a3bd1446779314cd/portable/GCC")," (",(0,i.kt)("inlineCode",{parentName:"p"},"port.c")," and ",(0,i.kt)("inlineCode",{parentName:"p"},"portmacro.h"),") or download a FreeRTOS release and find the files in there."),(0,i.kt)("p",{parentName:"li"},"Replace ",(0,i.kt)("inlineCode",{parentName:"p"},"port.c"),":"),(0,i.kt)(r.Z,{imageSource:"/img/miscellaneous/known-issues/keil-port-c.png",noShadow:!0,width:"250",mdxType:"Figure"},"port.c"),(0,i.kt)("p",{parentName:"li"},"Change your include path settings to include ",(0,i.kt)("inlineCode",{parentName:"p"},"portmacro.h")," from the ",(0,i.kt)("inlineCode",{parentName:"p"},"portable/GCC")," folder (in this case for Cortex-M7):"),(0,i.kt)(r.Z,{imageSource:"/img/miscellaneous/known-issues/keil-port-include.png",noShadow:!0,width:"600",mdxType:"Figure"},"Portable include path")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},'TouchGFX designer Post-Generate step during "Generate Code" will automatically insert the correct library based on the compiler version you\'ve chosen.'))),(0,i.kt)("h2",g({},{id:"touchgfx-4130"}),"TouchGFX 4.13.0"),(0,i.kt)("h3",g({},{id:"bugs"}),"Bugs"),(0,i.kt)("h4",g({},{id:"font-converter"}),"Font Converter"),(0,i.kt)("p",null,"The FontConverter tool would generate glyph pixel data for unicodes that were a part of a rule in the font, regardless of that glyph being used in an actual text in the application. This led to several megabytes, potentially, of additional glyph pixel data. New FontConverter tools (windows and linux) that no longer generate pixel data for glyphs that aren't in use by the application can be found here:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",g({parentName:"li"},{href:"http://sw-center-st-com.s3-eu-west-1.amazonaws.com/touchgfx/TouchGFX/Patches/4.13.0/fontconvert_fix.zip"}),"fontconvert_fix.zip"))),(0,i.kt)("p",null,"Extracting this file at the root of your 4.13.0 installation will update the fontconverter binaries inside"),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"touchgfx\\framework\\tools")),(0,i.kt)("h3",g({},{id:"additional-compiler-support"}),"Additional Compiler Support"),(0,i.kt)("p",null,"A library built with ARMCLANG compiler (v6.12) can be found here:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",g({parentName:"li"},{href:"http://sw-center-st-com.s3-eu-west-1.amazonaws.com/touchgfx/TouchGFX/Patches/4.13.0/touchgfx_core_clang.zip"}),"touchgfx_core_clang.zip"))),(0,i.kt)("p",null,"Extracting this file at the root of your 4.13.0 installation will place the library ",(0,i.kt)("inlineCode",{parentName:"p"},"touchgfx_core_clang.lib")," inside."),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"touchgfx\\lib\\core\\cortex_m7\\Keil")),(0,i.kt)("h3",g({},{id:"backwards-compatibility"}),"Backwards Compatibility"),(0,i.kt)("h4",g({},{id:"deprecated-features"}),"Deprecated Features"),(0,i.kt)("p",null,"The following deprecated features have been removed. If you have referenced them in your code, you may need to rewrite parts of your application:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Definition of deprecated ",(0,i.kt)("inlineCode",{parentName:"li"},"TRANSPARENT_COL")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"Drawable::getType()")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"HAL::blitSetTransparencyKey()")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"HAL::registerTextCache()")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"HAL::cacheTextString()"))),(0,i.kt)("h4",g({},{id:"texturemapper-is-disabled-by-default"}),"TextureMapper is Disabled by Default"),(0,i.kt)("p",null,"The TextureMapper is disabled by default to reduce the code space used by TouchGFX. TouchGFX designer will insert code to enable texture mapper in all new project."),(0,i.kt)("p",null,"If you are migrating an old project to TouchGFX 4.13 and you are updating to TouchGFX 4.13 this is handled by TouchGFX Designer."),(0,i.kt)("p",null,"If you are updating manually then you need to insert code to enable the TextureMapper. Otherwise any TextureMapper will not draw on the screen."),(0,i.kt)("p",null,"Read more here:\xa0",(0,i.kt)("a",g({parentName:"p"},{href:"../development/ui-development/designer-user-guide/config-view#framework-features"}),"Configuring TouchGFX Features"),"."),(0,i.kt)("h4",g({},{id:"hal-sdl1-incompatible"}),"HAL SDL1 incompatible"),(0,i.kt)("p",null,"Two functions were moved from the TouchGFX library code to the ",(0,i.kt)("inlineCode",{parentName:"p"},"HALSDL2.cpp"),". This makes no difference for applications that uses the ",(0,i.kt)("inlineCode",{parentName:"p"},"HALSDL2.cpp")," as HAL for the Windows simulator."),(0,i.kt)("p",null,"If you have a old application (before TouchGFX 4.8.0) your simulator is maybe using HALSDL (not 2). This simulator HAL is not included in TouchGFX anymore. The HALSDL is missing the two functions that were previously included in the TouchGFX library. You need to add them manually to ",(0,i.kt)("inlineCode",{parentName:"p"},"HALSDL.cpp"),":"),(0,i.kt)(a.Z,{mdxType:"CodeHeader"},"HALSDL.cpp"),(0,i.kt)("pre",null,(0,i.kt)("code",g({parentName:"pre"},{className:"language-cpp"}),'void simulator_enable_stdio();\nvoid simulator_enable_stdio()\n{\n    HWND consoleHwnd = GetConsoleWindow(); // Get handle of console window\n    if (!consoleHwnd)                      // No console window yet?\n    {\n        HWND activeHwnd = GetActiveWindow(); // Remember which window is active\n\n        AllocConsole();                   // Allocate a new console\n        consoleHwnd = GetConsoleWindow(); // Get handle of console window\n\n        FILE* dummy;\n        freopen_s(&dummy, "CONIN$", "r", stdin); // Redirect stdin/stdout/stderr to the new console\n        freopen_s(&dummy, "CONOUT$", "w", stdout);\n        freopen_s(&dummy, "CONOUT$", "w", stderr);\n\n        SwitchToThisWindow(activeHwnd, true); // Switch back to the originally active window\n    }\n    if (consoleHwnd)\n    {\n        ShowWindow(consoleHwnd, SW_SHOW); // Show/hide it!\n    }\n}\nvoid simulator_printf(const char* format, va_list pArg);\nvoid simulator_printf(const char* format, va_list pArg)\n{\n    // Create a console window, if window is visible.\n    simulator_enable_stdio();\n    if (GetConsoleWindow()) // Only print if we have a console window\n    {\n        vprintf(format, pArg);\n    }\n}\n')),(0,i.kt)("h2",g({},{id:"touchgfx-4123"}),"TouchGFX 4.12.3"),(0,i.kt)("h3",g({},{id:"backwards-compatibility-1"}),"Backwards compatibility"),(0,i.kt)("h4",g({},{id:"screen-transitions"}),"Screen transitions"),(0,i.kt)("p",null,"Earlier versions are redrawing the entire screen after a screen transition is completed.\xa0This additional redraw caused performance issues on some slow platforms. If you require this redraw for some reason, you need to invalidate the relevant part of the screen, e.g. by calling ",(0,i.kt)("inlineCode",{parentName:"p"},"container.invalidate()")," in the ",(0,i.kt)("inlineCode",{parentName:"p"},"Screen::afterTransition()")," virtual of the Screen transitioned to."),(0,i.kt)("h4",g({},{id:"binary-fonts"}),"Binary Fonts"),(0,i.kt)("p",null,"The format of the binary fonts has changed because kerning data is now also included in the binary fonts. Binary font files needs to be regenerated, old files will not work correctly. Depending on how your Makefiles are setup, this is normally done by regenerating all assets (e.g. ",(0,i.kt)("inlineCode",{parentName:"p"},"make -f simulator/gcc/Makefile clean assets"),")."),(0,i.kt)("h2",g({},{id:"touchgfx-4110"}),"TouchGFX 4.11.0"),(0,i.kt)("h3",g({},{id:"backwards-compatibility-2"}),"Backwards compatibility"),(0,i.kt)("p",null,"In ",(0,i.kt)("inlineCode",{parentName:"p"},"touchgfx/framework/include/touchgfx/lcd/LCD.hpp")," we have removed an include of the file ",(0,i.kt)("inlineCode",{parentName:"p"},"touchgfx/hal/HAL.hpp")," that was inserted by mistake in an earlier version. This may give you a compile error in a file where you have included ",(0,i.kt)("inlineCode",{parentName:"p"},"LCD.hpp")," and also make use of the ",(0,i.kt)("inlineCode",{parentName:"p"},"HAL.hpp")," content. The solution is to also include\xa0",(0,i.kt)("inlineCode",{parentName:"p"},"touchgfx/framework/include/touchgfx/hal/HAL.hpp")," in your file."),(0,i.kt)("h2",g({},{id:"touchgfx-4100"}),"TouchGFX 4.10.0"),(0,i.kt)("h3",g({},{id:"upgrading-from-49x"}),"Upgrading from 4.9.x"),(0,i.kt)("p",null,"From version 4.10.0 TouchGFX runs exclusively on STM32 MCUs."),(0,i.kt)("p",null,"You need to do the following if updating an old project."),(0,i.kt)("p",null,"Add the highlighted code below at application startup to inform TouchGFX that you are running on STM32 hardware. A suitable location is the end of the ",(0,i.kt)("inlineCode",{parentName:"p"},"hw_init()")," function in ",(0,i.kt)("inlineCode",{parentName:"p"},"BoardConfiguration.cpp")),(0,i.kt)(a.Z,{mdxType:"CodeHeader"},"BoardConfiguration.cpp"),(0,i.kt)("pre",null,(0,i.kt)("code",g({parentName:"pre"},{className:"language-cpp"}),"void hw_init() {\n    ...\n    //Enable CRC engine for STM32 Lock check\n    __HAL_RCC_CRC_CLK_ENABLE();\n}\n")),(0,i.kt)("h3",g({},{id:"backwards-compatibility-3"}),"Backwards compatibility"),(0,i.kt)("p",null,"Unused file ",(0,i.kt)("inlineCode",{parentName:"p"},"\\touchgfx\\framework\\include\\touchgfx\\canvas_widget_renderer\\RGBA8.hpp")," removed."),(0,i.kt)("h3",g({},{id:"project-updater-issue"}),"Project Updater Issue"),(0,i.kt)("p",null,"IAR and Keil project updaters invoked from TouchGFX Designer do not respect custom file level optimization set in the respective IDE."),(0,i.kt)("h3",g({},{id:"textarea-and-chromart-dma2d"}),"TextArea and ChromART (DMA2D)"),(0,i.kt)("p",null,"Rendering of TextAreas with ChromART (when TextArea is the top most element / last to be drawn) cause a premature unlocking of the framebuffer and subsequently a premature completion/transfer of the current frame to the display. Once ",(0,i.kt)("inlineCode",{parentName:"p"},"endFrame()")," is called by TouchGFX all drawing operations, including DMA operations, should already be completed. Due to a breach of contract by TextArea in how to appropriately protect the framebuffer, DMA operations are allowed to continue even after returning from ",(0,i.kt)("inlineCode",{parentName:"p"},"endFrame()"),"."),(0,i.kt)("p",null,"The contract for a widget is to either:"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},"Lock the framebuffer (returns a pointer to framebuffer)."),(0,i.kt)("li",{parentName:"ol"},"Draw something in the framebuffer.\xa0"),(0,i.kt)("li",{parentName:"ol"},"Unlock the framebuffer.")),(0,i.kt)("p",null,"Or to use DMA operations, in which case syncronization of the framebuffer is handled automatically."),(0,i.kt)("p",null,"TextArea, in 4.10.0, mixes the two procedures which can cause glitches if it is the top most element (last to be drawn) of the current screen. The bug can be fixed by manually guarding ",(0,i.kt)("inlineCode",{parentName:"p"},"endFrame()")," with the following override of ",(0,i.kt)("inlineCode",{parentName:"p"},"endFrame()")," (based on F4 HAL). It ensures that ",(0,i.kt)("inlineCode",{parentName:"p"},"endFrame()")," does not return if ChromART operations are still being processed.\xa0\xa0"),(0,i.kt)("pre",null,(0,i.kt)("code",g({parentName:"pre"},{className:"language-cpp"}),"void STM32F4HAL::endFrame()\n{\n    if (dma.isDMARunning())\n    {\n        OSWrappers::tryTakeFrameBufferSemaphore();\n    }\n    HAL::endFrame();\n}\n")),(0,i.kt)("h2",g({},{id:"touchgfx-490"}),"TouchGFX 4.9.0"),(0,i.kt)("h3",g({},{id:"upgrading-from-480"}),"Upgrading from 4.8.0"),(0,i.kt)("p",null,"With the introduction of Application Templates, which essentially separates board support packages from the core framework, we have removed a lot of low-level drivers and other files from the ",(0,i.kt)("em",{parentName:"p"},"touchgfx")," folder in 4.9.0. These files are now provided by application templates instead. However, this means that you cannot upgrade to 4.9.0 by just replacing the touchgfx folder, since that would likely lead to some BSP files missing. Instead, the TouchGFX Designer is able to perform the upgrade automatically. The upgrade can be done in two different ways, and you will need to decide which one is most suitable for you."),(0,i.kt)(o.Z,{mdxType:"Caution"},"Please make sure you have a backup of your project before upgrading"),(0,i.kt)("h3",g({},{id:"method-1-retain-original-file-structure"}),"Method 1: retain original file structure"),(0,i.kt)("p",null,"This method is done by simply opening your project in the new 4.9.0 Designer. TouchGFX Designer will prompt you whether you want to upgrade, and by clicking OK, TouchGFX Designer will apply the necessary changes. TouchGFX Designer will perform the following operations:"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},"Unpack the new reduced touchgfx folder into your application, and modify your TouchGFX path to match this"),(0,i.kt)("li",{parentName:"ol"},"Download and unpack all the files we have removed from the touchgfx folder, so that your project still compiles")),(0,i.kt)("p",null,"This approach will leave pretty much everything as they used to be, so if the old file structure suits your project, this is the easiest choice. The main drawback is that you will not have the benefit of the image converter speedup (by working on image folders instead of individual files). But you can modify your makefile manually to use this approach though."),(0,i.kt)("h3",g({},{id:"method-2-import-into-new-template"}),"Method 2: import into new template"),(0,i.kt)("p",null,'Using this method you can transition your project into the new template-based file organisation. To achieve this, you must first let the Designer upgrade your project using Method 1 above. Then, create a new project using the appropriate application template (simulator, or one matching your eval board). With this new project opened in the Designer, go to the top menu and click "Edit -> Import GUI". In the dialog box point out the .touchgfx file of your project. The Designer will then automatically import all the UI files, including assets, into the newly created project. If you have added additional code outside of the gui folder, you would need to manually copy those files over to the new project.'),(0,i.kt)("h3",g({},{id:"method-3-manual-upgrade-without-designer"}),"Method 3: Manual upgrade without Designer"),(0,i.kt)("p",null,"If you are not using the Designer, you can perform the upgrade by:"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},"Replacing the touchgfx folder used by your project with the one from the 4.9.0 installation."),(0,i.kt)("li",{parentName:"ol"},"Download ",(0,i.kt)("a",g({parentName:"li"},{href:"http://ftp.draupnergraphics.com/TouchGFX/Evaluation/4.9.0/Qll3iKK54AnJer7XRNm2/fw_delta_4.8.0_4.9.0.zip"}),"this zip")," and unpack it into the touchgfx folder, restoring the removed files.")))}x.isMDXComponent=!0}}]);